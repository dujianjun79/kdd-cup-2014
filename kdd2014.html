<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>kdd2014 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableDynamicAutoCompleteResourceLoading":false,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":true,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":true,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"4.0.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"jxd151630@utdallas.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"shouldShowCommandStatus":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db6-rc-scala2.10","displayName":"Spark 2.1.1-db6 RC (Scala 2.10)","packageLabel":"spark-image-14d360d0fb023c9b3b9ee0f54aa21102b41e64403c083aafea1bdae65af9d2fc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-rc-scala2.10","displayName":"3.0 RC (Scala 2.10)","packageLabel":"spark-image-79d4164ac1b15229a637976d5ff93171e8215d31bb60b66b8aad0c292ef09faa","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-9ca1cc8ada00cd25e315c1bbb385f801d34459abe0231f025f4f1fe8e00e567d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.1.x-rc-ml-gpu-scala2.11","displayName":"ML Runtime (4.1.x, GPU, Scala 2.11)","packageLabel":"spark-image-9c3a3a53725ae0bcbc7387cb40dc868daf8d9b3935a04901b9f854169bb1a369","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db5-rc-scala2.11","displayName":"Spark 2.1.1-db5 RC (Scala 2.11)","packageLabel":"spark-image-4af1e533519dfa2398e219d3ee681f0b7d0f41419094c144b7871d60a13c8e64","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-7ce07ae16a775d917d6748d2075807565c157286f4f5957c1b77275b3b2a9bc4","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-1096548c9598119ed8704dcb9c7e606e19112d19dca9635984337091af698f2d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.1.x-scala2.11","displayName":"4.1 beta (Scala 2.11)","packageLabel":"spark-image-2dd1981cc92280597f43187bb7e83ac1021da3e30b7ead65e183c0a19d0c7329","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-4efc0c94e152791782f2cb865ac1eb3c11985a2671a77e6ef930f9718851459d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-ab147bdd6662fef83fa48e41d909aa045422585552758dc667f1971876c4486f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-550001766b18e8b019812cf05bc92548f0fa650fba38932a53e0a205c1b1d284","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5 RC (Scala 2.11)","packageLabel":"spark-image-cf04258c7d48813694aac95311c536ba8b14a5ba644b51c1ef5c51126796a135","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0 RC (Scala 2.11)","packageLabel":"spark-image-0c5fa1fa59d7a772f5a8d5772a14cdaf93889f68575fc5320144bcde5167575c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"4.1.x-rc-ml-scala2.11","displayName":"ML Runtime (4.1.x, Scala 2.11)","packageLabel":"spark-image-f564ecfce1df43cc522fbc87d328ab5a62dc30cb15e57dc89daa6ce816ebfcde","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-0101ba46f619bc121062962bd840c2158cabae8d3813ccb2f7e2f6d0156dcd15","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-df8cc994cad714f421402299ae687860b127e8e937d8b5246d3a6a4ff4a33f2e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-25dac86138b91b354c5882419df5c45cd3695fb36b3a14ad63ff459cd7ae28b8","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-e50cbe4c0b0ad46930872eff4b69665890fd6a170e2b1a3e48c1cdea5823fd86","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-ce7f1e5fd3845ad79f4f4e77439d87b15e1b34681f8db2f011ca11df93732876","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-0101ba46f619bc121062962bd840c2158cabae8d3813ccb2f7e2f6d0156dcd15","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-rc-scala2.10","displayName":"Spark 2.1.1-db4 RC (Scala 2.10)","packageLabel":"spark-image-f86c7f2bd281940253f2263085a7ec8a2285019e3e4af1a17b68fa506e781169","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-rc-scala2.10","displayName":"Spark 2.1.1-db5 RC (Scala 2.10)","packageLabel":"spark-image-d62c35676896dd561067dc130a3887e37bbedb06922531f1044899f252633fc7","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-62365f2d91529bc1128d8968f33d07f5b8d75cf7305de9455bc970e6e1fecbb4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 beta, Scala 2.11)","packageLabel":"spark-image-2dd1981cc92280597f43187bb7e83ac1021da3e30b7ead65e183c0a19d0c7329","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-550001766b18e8b019812cf05bc92548f0fa650fba38932a53e0a205c1b1d284","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db6-rc-scala2.11","displayName":"Spark 2.1.1-db6 RC (Scala 2.11)","packageLabel":"spark-image-1760457f657e9cea8b7d050c4dac7751972378fba1e280d8617ed4eb275eb1d1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-0adabd34980ecfcbc6a48ac5c9e3a954cf5ec3a53a3300ae0e392c03299d89ca","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3 RC (Scala 2.11)","packageLabel":"spark-image-2c45b46b468798c59fa2f2f6c0fde138cd8cd0df90a0a641b0cfd3681a4d6dd4","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4 RC (Scala 2.11)","packageLabel":"spark-image-89f7bd3938db3a936b5dcae575e3ccc2eaf179974625fe12db76816f034eb625","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.1.x-rc-scala2.11","displayName":"4.1 RC (Scala 2.11)","packageLabel":"spark-image-2dd1981cc92280597f43187bb7e83ac1021da3e30b7ead65e183c0a19d0c7329","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-d260134c6ee63ddc781bebdf692bc0db943151dc1c1de0e667d14f09da57fc39","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db4-rc-scala2.11","displayName":"Spark 2.1.1-db4 RC (Scala 2.11)","packageLabel":"spark-image-7f4016da4ffed9582b3afe8ba2be01f5ee17cd4c7303d1599c9d62b09c2734c6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-fe8300ae2b3bf12c79ce76d7e9d2d03995e58d1497cfb6c0d3172efb630cb2df","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0 RC (GPU, Scala 2.11)","packageLabel":"spark-image-1e4f85514913a00d3586e2aa361abf1b220c6e1ab81f15b4066a997dc233f3d2","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.1.x-gpu-scala2.11","displayName":"4.1 beta (GPU, Scala 2.11)","packageLabel":"spark-image-76d3ce51b3a1357305b2d88a64c4ec5aed515b3069a16cb35c8e9fc15ae7218d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-d747df35392b5470586d9a614ac5f970aa1261242d92869f8d8934c567f09c2d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3 RC (Scala 2.10)","packageLabel":"spark-image-d36d45c7d38127b93eff791ae000269f7a309aa6c131f0c0552c4d8d7ca445d2","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-0112f566715b00d5aceb1b98543285bcb3a0f38174b86abd1c096c3e861043eb","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"[DEPRECATED] Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4 RC (Scala 2.10)","packageLabel":"spark-image-e6a63d7b8a123f50fef2c98ae04f17120ab7f5daadd1f2e6c8ffe2b9e3486c4e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.1.x-rc-scala2.10","displayName":"3.1 RC (Scala 2.10)","packageLabel":"spark-image-6fcbd8b8a68c3b98cc124b235e712abad2cfb1a0943665adc04405b511a9889f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-07da7d24ad964d7a43f53bd9feac55de7df890ef6e5f6bac8975fb7aa3e2a0a7","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-a3f7a87b2734de62a5573e043415f1bc6301bd7dcea1c55ae768eae2378eb697","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.2 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-3f7f4997e9646ef6f262e4e78a3eaeb7d0914705cb31b0785974c114b766b311","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.2.x-rc-scala2.11","displayName":"3.2 RC (Scala 2.11)","packageLabel":"spark-image-17037aa3bc1143c9e5b68a81c140af62574a27ccd8e45a05b93e88b035d3aea1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0d3a99d46a4c55642850b5eba9aad3b56ffb9adbe8c8893403eba834399960fc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-1f615934d3e248da8dcfb3e03bd8d92e933a17845fedb7cce12af2a0220ba6a2","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-rc-scala2.11","displayName":"3.0 RC (Scala 2.11)","packageLabel":"spark-image-6cfcb66fb2b15e23cee6390510aeb485992749470de25a07f2c4131101bb20da","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-bbebd3ed3dc4dc312a4338509a0490a1879300c8c26d7d2fa6cf2367c4ba268c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-c6b477859faf291f56ac2dcbe6f6693d60e403c12dfcac58892b4014614363c3","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5d8f05afc7c7e64723ddb0b39e6d68acef5aafdc3f089e795e931d589b7da5a2","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-9158d808c11f3b39b1de8a3d39646a0581142e141f387a10ef18dc7b94ecf7dc","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-c8547fab0cc66b918f9a64c7e35532de209d0d0e06da6078ad787ec718b37e7b","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-0067951c626cad90625cce4d2dcf3e00a1029375f8e5470d2330036d0d3c505f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-b512ba976616af10269438701339a9bd5a97cc386737c6ecffdda5fb31c3cf20","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-272e0cdbeaa23cad80675e7c1dbbc559bb5be7582c45b43ab14522353e512d84","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.1.x-rc-scala2.11","displayName":"3.1 RC (Scala 2.11)","packageLabel":"spark-image-462d1c1ae6703da2908b8595dc0ae2493882c706ec3431539e0880ea48febb44","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.1.x-rc-gpu-scala2.11","displayName":"4.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-76d3ce51b3a1357305b2d88a64c4ec5aed515b3069a16cb35c8e9fc15ae7218d","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.2 snapshot, Scala 2.11)","packageLabel":"spark-image-dd988b352ec79f9a4a8e81f6fe2d4fe0b3deba871fde490aa1c980e5ad4be5d0","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-3b22b5c8d5577281bcca8dd6ef07553fb32b3b99ab977f8bdb7238f850ece887","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-0ea14d4a8a71de38872dd398b1139d55302680cfe3e9da217576c8304cd19b24","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 beta, GPU, Scala 2.11)","packageLabel":"spark-image-76d3ce51b3a1357305b2d88a64c4ec5aed515b3069a16cb35c8e9fc15ae7218d","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5 RC (Scala 2.10)","packageLabel":"spark-image-53fb1559210e523e6ff7b55811f914fe40f191d051d74b05b24955d987518f3e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-79b2040b76908f9744b2c5c4f7ed42eed613084b596dffc265bfced1e9c013e2","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.2.x-rc-scala2.10","displayName":"3.2 RC (Scala 2.10)","packageLabel":"spark-image-0f0ab9fa26996f36fb93e30e80a57adf9680989c5b187baa5500dd9670327357","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"Standard_E64s_v3":16,"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"Standard_D11_v2":0.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_NC6":2,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_D13_v2":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_NC24":8,"Standard_NC24r":8,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_D14_v2":4,"Standard_H16":4,"Standard_NC12":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_D15_v2":5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"Standard_D12_v2":1,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"Standard_D4_v2":1.5,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.69.54","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":1000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-550001766b18e8b019812cf05bc92548f0fa650fba38932a53e0a205c1b1d284","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":100,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"jxd151630@utdallas.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true","spark.databricks.repl.allowedLanguages":"python,sql"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https?://(docs\\.databricks\\.com/_static/notebooks/|files\\.training\\.databricks\\.com/).+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":true,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableUserPromptForPendingRpc":true,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3413744942634565,"name":"kdd2014","language":"scala","commands":[{"version":"CommandV1","origId":3059902435747512,"guid":"d2ae2b90-d967-4eff-9093-bdf2095c5238","subtype":"command","commandType":"auto","position":0.5,"command":"import org.apache.spark.sql.types.DataType\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions.corr\nimport org.apache.spark.ml.regression.LinearRegression\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.ml.feature.{VectorAssembler,StringIndexer}\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\nimport org.apache.spark.sql.types.DoubleType\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.feature.OneHotEncoderEstimator\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.types.DataType\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions.corr\nimport org.apache.spark.ml.regression.LinearRegression\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.ml.feature.{VectorAssembler, StringIndexer}\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\nimport org.apache.spark.sql.types.DoubleType\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.feature.OneHotEncoderEstimator\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750344642,"submitTime":1524750344611,"finishTime":1524750344858,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80b635cb-a8f6-4453-90d7-89eb18b09a20"},{"version":"CommandV1","origId":3413744942634566,"guid":"96aab0f3-4a06-46d1-befe-b49926123a15","subtype":"command","commandType":"auto","position":1.0,"command":"val donations = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"/FileStore/tables/donations.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">donations: org.apache.spark.sql.DataFrame = [donationid: string, projectid: string ... 19 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"donations","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"donationid","type":"string","nullable":true,"metadata":{}},{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"donor_acctid","type":"string","nullable":true,"metadata":{}},{"name":"donor_city","type":"string","nullable":true,"metadata":{}},{"name":"donor_state","type":"string","nullable":true,"metadata":{}},{"name":"donor_zip","type":"string","nullable":true,"metadata":{}},{"name":"is_teacher_acct","type":"string","nullable":true,"metadata":{}},{"name":"donation_timestamp","type":"string","nullable":true,"metadata":{}},{"name":"donation_to_project","type":"string","nullable":true,"metadata":{}},{"name":"donation_optional_support","type":"string","nullable":true,"metadata":{}},{"name":"donation_total","type":"string","nullable":true,"metadata":{}},{"name":"dollar_amount","type":"string","nullable":true,"metadata":{}},{"name":"donation_included_optional_support","type":"string","nullable":true,"metadata":{}},{"name":"payment_method","type":"string","nullable":true,"metadata":{}},{"name":"payment_included_acct_credit","type":"string","nullable":true,"metadata":{}},{"name":"payment_included_campaign_gift_card","type":"string","nullable":true,"metadata":{}},{"name":"payment_included_web_purchased_gift_card","type":"string","nullable":true,"metadata":{}},{"name":"payment_was_promo_matched","type":"string","nullable":true,"metadata":{}},{"name":"via_giving_page","type":"string","nullable":true,"metadata":{}},{"name":"for_honoree","type":"string","nullable":true,"metadata":{}},{"name":"donation_message","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750346441,"submitTime":1524750346411,"finishTime":1524750356454,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"494035ea-80b5-47dc-99c0-aa7b6cd0e5cf"},{"version":"CommandV1","origId":3413744942634568,"guid":"83d6fc46-6c8b-4cd5-bb11-607d76ac4b26","subtype":"command","commandType":"auto","position":2.0,"command":"donations.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+--------------------+--------------------+--------------+-----------+---------+---------------+--------------------+-------------------+-------------------------+--------------+-------------+----------------------------------+----------------+----------------------------+-----------------------------------+----------------------------------------+-------------------------+---------------+-----------+--------------------+\n|          donationid|           projectid|        donor_acctid|    donor_city|donor_state|donor_zip|is_teacher_acct|  donation_timestamp|donation_to_project|donation_optional_support|donation_total|dollar_amount|donation_included_optional_support|  payment_method|payment_included_acct_credit|payment_included_campaign_gift_card|payment_included_web_purchased_gift_card|payment_was_promo_matched|via_giving_page|for_honoree|    donation_message|\n+--------------------+--------------------+--------------------+--------------+-----------+---------+---------------+--------------------+-------------------+-------------------------+--------------+-------------+----------------------------------+----------------+----------------------------+-----------------------------------+----------------------------------------+-------------------------+---------------+-----------+--------------------+\n|431d720bc3dfd75ae...|ffffac55ee02a49d1...|22cbc920c9b5fa08d...|Peachtree City|         GA|    30269|              f|2011-08-25 14:27:...|              42.50|                     7.50|         50.00|    10_to_100|                                 t|no_cash_received|                           f|                                  t|                                       f|                        f|              f|          f|I gave to this pr...|\n|fcfedba1c8a0ba77d...|ffffac55ee02a49d1...|521f1830a77c9dbbf...|          null|         GA|     null|              f|2011-11-04 07:54:...|              26.83|                     4.73|         31.56|    10_to_100|                                 t|      creditcard|                           f|                                  t|                                       f|                        f|              f|          f|I donated because...|\n|3fa95d29986aa6f40...|ffffac55ee02a49d1...|1e0a63fc8141c7ba2...|     Rockville|         MD|    20853|              f|2011-11-02 22:53:...|              55.35|                     0.00|         55.35|    10_to_100|                                 f|no_cash_received|                           t|                                  f|                                       f|                        f|              t|          f|The Spark's 'pet'...|\n|020ad6bd5e88a3574...|ffffac55ee02a49d1...|1d4acb508df29d5f1...|         Salem|         IN|    47167|              f|2011-11-03 23:54:...|               8.50|                     1.50|         10.00|    10_to_100|                                 t|          paypal|                           f|                                  f|                                       f|                        f|              f|          f|I gave to this pr...|\n|4b44b03f304d6425a...|ffffac55ee02a49d1...|59c3c3cfcccc53ae8...|     anonymous|       null|    00000|              f|2011-11-02 23:21:...|              20.00|                     0.00|         20.00|    10_to_100|                                 f|no_cash_received|                           f|                                  f|                                       t|                        f|              t|          f|I lent a paw to h...|\n|9be4b22432cae4c9a...|ffffac55ee02a49d1...|2215e4e3f54e88342...|          null|       null|     null|              f|2011-10-16 20:59:...|               4.25|                     0.75|          5.00|     under_10|                                 t|no_cash_received|                           f|                                  t|                                       f|                        f|              f|          f|I helped because ...|\n|d638145f90a23325b...|ffffac55ee02a49d1...|f1b43a3b756a68b20...|          null|         GA|     null|              f|2011-08-31 08:13:...|              50.00|                     0.00|         50.00|    10_to_100|                                 f|      creditcard|                           f|                                  f|                                       f|                        f|              f|          t|I helped because ...|\n|b39547f29dfc25fb1...|ffff97ed93720407d...|12bc331b479e327d8...|          null|         NY|     null|              f|2010-11-12 16:11:...|             212.50|                    37.50|        250.00|   100_and_up|                                 t|      creditcard|                           f|                                  f|                                       f|                        f|              t|          f|I gave to this pr...|\n|471e89e99b76bc0a8...|ffff97ed93720407d...|1fe8c1543e1196902...|          null|       null|     null|              f|2010-12-01 14:52:...|             185.01|                    32.65|        217.66|   100_and_up|                                 t|      creditcard|                           f|                                  f|                                       f|                        f|              t|          f|Donation on behal...|\n|87f432143e452c459...|ffff97ed93720407d...|6cec8667bfe0c941c...|          null|       null|     null|              f|2010-11-23 09:09:...|              21.25|                     3.75|         25.00|    10_to_100|                                 t|      creditcard|                           f|                                  f|                                       f|                        f|              t|          f|I gave to this pr...|\n|d5782c7d267baabe1...|ffff97ed93720407d...|6cec8667bfe0c941c...|          null|       null|     null|              f|2010-11-18 10:29:...|              21.25|                     3.75|         25.00|    10_to_100|                                 t|      creditcard|                           f|                                  f|                                       f|                        f|              t|          f|I gave to this pr...|\n|454d988d26bf531e9...|ffff418bb42fad243...|3afd51f30b4c24ac7...|          null|         TX|     null|              f|2009-08-28 11:17:...|              20.50|                     4.50|         25.00|    10_to_100|                                 t|          amazon|                           f|                                  f|                                       f|                        f|              t|          f|I gave to this pr...|\n|44842bc73032bcc4b...|ffff2d9c769c8fb53...|ca2858ac1c427f52e...|          null|         ID|    83201|              f|2013-05-09 17:08:...|              58.65|                    10.35|         69.00|    10_to_100|                                 t|      creditcard|                           f|                                  f|                                       f|                        t|              t|          f|Education is the ...|\n|45b90c3d8cbf06a4c...|ffff2d9c769c8fb53...|38fcf7f544893c94a...|          null|         NY|     null|              f|2013-03-06 22:48:...|              85.00|                    15.00|        100.00|   100_and_up|                                 t|promo_code_match|                           f|                                  f|                                       f|                        f|              t|          f|Matching donation...|\n|9047579ce6a5c45ab...|ffff2d9c769c8fb53...|2f471330531031f76...|          null|         CO|    80003|              f|2013-03-06 22:47:...|              85.00|                    15.00|        100.00|   100_and_up|                                 t|      creditcard|                           f|                                  f|                                       f|                        t|              t|          f|I gave because we...|\n|9e0f234dfa2982619...|ffff2d9c769c8fb53...|af1f03b856fc2979c...|     Pocatello|         ID|    83201|              f|2013-05-08 12:58:...|              68.00|                    12.00|         80.00|    10_to_100|                                 t|      creditcard|                           f|                                  t|                                       f|                        f|              f|          f|Idaho Power Compa...|\n|fdcd840e3dd570165...|ffff2d9c769c8fb53...|af1f03b856fc2979c...|     Pocatello|         ID|    83201|              f|2013-05-08 13:18:...|              12.75|                     2.25|         15.00|    10_to_100|                                 t|no_cash_received|                           f|                                  t|                                       f|                        f|              f|          f|We beleive in Edu...|\n|0a5e96e7ac5fe374b...|ffff2d9c769c8fb53...|d558e11dfea406d7b...|          null|         ID|    83605|              f|2013-03-07 22:58:...|              85.00|                    15.00|        100.00|   100_and_up|                                 t|      creditcard|                           f|                                  f|                                       f|                        f|              f|          f|I gave because no...|\n|15ffbe32a7efdbd8b...|ffff2d9c769c8fb53...|7b803ccdf84110e55...|          null|         ID|    83201|              f|2013-03-06 18:43:...|              21.25|                     3.75|         25.00|    10_to_100|                                 t|      creditcard|                           f|                                  f|                                       f|                        t|              t|          f|I gave because I ...|\n|7d4c6a51214f38e92...|ffff2d9c769c8fb53...|38fcf7f544893c94a...|          null|         NY|     null|              f|2013-03-08 13:55:...|              42.50|                     7.50|         50.00|    10_to_100|                                 t|promo_code_match|                           f|                                  f|                                       f|                        f|              t|          f|Matching donation...|\n+--------------------+--------------------+--------------------+--------------+-----------+---------+---------------+--------------------+-------------------+-------------------------+--------------+-------------+----------------------------------+----------------+----------------------------+-----------------------------------+----------------------------------------+-------------------------+---------------+-----------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">notebook:1: error: not found: value donations\ndonations.show()\n^\n</div>","error":null,"workflows":[],"startTime":1524750356501,"submitTime":1524750348844,"finishTime":1524750362718,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dd59459d-ee06-49f5-b4b4-5a0619dbe63e"},{"version":"CommandV1","origId":3413744942634569,"guid":"fece326e-3b6a-4f12-a981-6468d494b05d","subtype":"command","commandType":"auto","position":3.0,"command":"val projects = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"/FileStore/tables/projects.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">projects: org.apache.spark.sql.DataFrame = [projectid: string, teacher_acctid: string ... 33 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"projects","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"teacher_acctid","type":"string","nullable":true,"metadata":{}},{"name":"schoolid","type":"string","nullable":true,"metadata":{}},{"name":"school_ncesid","type":"string","nullable":true,"metadata":{}},{"name":"school_latitude","type":"string","nullable":true,"metadata":{}},{"name":"school_longitude","type":"string","nullable":true,"metadata":{}},{"name":"school_city","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_zip","type":"string","nullable":true,"metadata":{}},{"name":"school_metro","type":"string","nullable":true,"metadata":{}},{"name":"school_district","type":"string","nullable":true,"metadata":{}},{"name":"school_county","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"school_nlns","type":"string","nullable":true,"metadata":{}},{"name":"school_kipp","type":"string","nullable":true,"metadata":{}},{"name":"school_charter_ready_promise","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"teacher_teach_for_america","type":"string","nullable":true,"metadata":{}},{"name":"teacher_ny_teaching_fellow","type":"string","nullable":true,"metadata":{}},{"name":"primary_focus_subject","type":"string","nullable":true,"metadata":{}},{"name":"primary_focus_area","type":"string","nullable":true,"metadata":{}},{"name":"secondary_focus_subject","type":"string","nullable":true,"metadata":{}},{"name":"secondary_focus_area","type":"string","nullable":true,"metadata":{}},{"name":"resource_type","type":"string","nullable":true,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"string","nullable":true,"metadata":{}},{"name":"total_price_excluding_optional_support","type":"string","nullable":true,"metadata":{}},{"name":"total_price_including_optional_support","type":"string","nullable":true,"metadata":{}},{"name":"students_reached","type":"string","nullable":true,"metadata":{}},{"name":"eligible_double_your_impact_match","type":"string","nullable":true,"metadata":{}},{"name":"eligible_almost_home_match","type":"string","nullable":true,"metadata":{}},{"name":"date_posted","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750362746,"submitTime":1524750357755,"finishTime":1524750365374,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"61ac4444-c618-430a-8efb-666864567460"},{"version":"CommandV1","origId":3413744942634570,"guid":"bc4d58ea-ab4f-4882-b2cd-964c55d85926","subtype":"command","commandType":"auto","position":4.0,"command":"projects.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+--------------------+--------------------+-------------+---------------+----------------+-------------+------------+----------+------------+--------------------+----------------+--------------+-------------+-----------------+-----------+-----------+----------------------------+--------------+-------------------------+--------------------------+---------------------+-------------------+-----------------------+--------------------+-------------+---------------+-------------+---------------------------+--------------------------------------+--------------------------------------+----------------+---------------------------------+--------------------------+-----------+\n|           projectid|      teacher_acctid|            schoolid|school_ncesid|school_latitude|school_longitude|  school_city|school_state|school_zip|school_metro|     school_district|   school_county|school_charter|school_magnet|school_year_round|school_nlns|school_kipp|school_charter_ready_promise|teacher_prefix|teacher_teach_for_america|teacher_ny_teaching_fellow|primary_focus_subject| primary_focus_area|secondary_focus_subject|secondary_focus_area|resource_type|  poverty_level|  grade_level|fulfillment_labor_materials|total_price_excluding_optional_support|total_price_including_optional_support|students_reached|eligible_double_your_impact_match|eligible_almost_home_match|date_posted|\n+--------------------+--------------------+--------------------+-------------+---------------+----------------+-------------+------------+----------+------------+--------------------+----------------+--------------+-------------+-----------------+-----------+-----------+----------------------------+--------------+-------------------------+--------------------------+---------------------+-------------------+-----------------------+--------------------+-------------+---------------+-------------+---------------------------+--------------------------------------+--------------------------------------+----------------+---------------------------------+--------------------------+-----------+\n|316ed8fb3b81402ff...|42d43fa6f37314365...|c0e6ce89b24476408...| 063627006187|      36.576340|     -119.608713|        Selma|          CA|     93662|        null|Selma Unified Sch...|          Fresno|             f|            f|                f|          f|          f|                           f|          Mrs.|                        f|                         f| Literature &amp; Writing|Literacy &amp; Language|   College &amp; Career ...|    Applied Learning|        Books|highest poverty|   Grades 6-8|                      30.00|                                555.81|                                653.89|              32|                                f|                         f| 2014-05-12|\n|90de744e368a7e488...|864eb466462bf704b...|d711e47810900c96f...| 483702008193|      32.911179|      -96.723640|       Dallas|          TX|     75243|       urban|Richardson Ind Sc...|          Dallas|             f|            f|                f|          f|          f|                           f|          Mrs.|                        f|                         f|             Literacy|Literacy &amp; Language|                    ESL| Literacy &amp; Language|        Books|highest poverty|Grades PreK-2|                      30.00|                                296.47|                                348.79|              22|                                f|                         f| 2014-05-12|\n|32943bb1063267de6...|37f85135259ece793...|665c3613013ba0a66...| 410327000109|      45.166039|     -122.414576|       Colton|          OR|     97017|       rural|Colton School Dis...|       Clackamas|             f|            f|                f|          f|          f|                           f|           Mr.|                        f|                         f|             Literacy|Literacy &amp; Language|            Mathematics|      Math &amp; Science|   Technology|   high poverty|Grades PreK-2|                      30.00|                                430.89|                                506.93|              17|                                f|                         f| 2014-05-11|\n|bb18f409abda2f264...|2133fc46f951f1e7d...|4f12c3fa0c1cce823...| 360015302507|      40.641727|      -73.965655|     Brooklyn|          NY|     11226|       urban|New York City Dep...|Kings (Brooklyn)|             f|            t|                f|          f|          f|                           f|           Mr.|                        t|                         f|      Social Sciences|   History &amp; Civics|          Special Needs|       Special Needs|        Books|highest poverty|   Grades 3-5|                      30.00|                                576.07|                                677.73|              12|                                f|                         f| 2014-05-11|\n|24761b686e18e5eac...|867ff478a63f5457e...|10179fd362d7b8cf0...| 062271003157|      34.043939|     -118.288371|  Los Angeles|          CA|     90006|       urban|Los Angeles Unif ...|     Los Angeles|             f|            f|                f|          f|          f|                           f|           Ms.|                        f|                         f|          Mathematics|     Math &amp; Science|               Literacy| Literacy &amp; Language|        Other|highest poverty|Grades PreK-2|                      30.00|                                408.40|                                480.47|              24|                                f|                         f| 2014-05-11|\n|eac7d156205f1333d...|ff064802c18e68db7...|929336e5a242d2e67...| 040187001058|      33.298792|     -111.827793|     Chandler|          AZ|     85225|    suburban|Chandler Unif Sch...|        Maricopa|             f|            f|                t|          f|          f|                           f|          Mrs.|                        f|                         f| Literature &amp; Writing|Literacy &amp; Language|                    ESL| Literacy &amp; Language|   Technology|highest poverty|   Grades 3-5|                      30.00|                                750.92|                                883.44|              20|                                f|                         f| 2014-05-11|\n|5a3bfdf2e05781ccd...|085794a9e315b88cb...|dc34b021fd177cfdb...| 010060000256|      32.838778|      -85.517527|    Lafayette|          AL|     36862|       rural|Chambers Co Schoo...|        Chambers|             f|            f|                f|          f|          f|                           f|           Mr.|                        f|                         f|        Gym &amp; Fitness|    Health &amp; Sports|                   null|                null|     Supplies|highest poverty|Grades PreK-2|                      30.00|                               2291.48|                               2695.86|             320|                                f|                         f| 2014-05-11|\n|afda16eb54d8992db...|1d94a31c2dc38d513...|86fff7caa07e4f595...| 130129000571|      33.896013|      -84.554213|     Marietta|          GA|     30060|        null|Cobb Co School Di...|            Cobb|             f|            f|                f|          f|          f|                           f|          Mrs.|                        f|                         f|             Literacy|Literacy &amp; Language|                   null|                null|        Books|highest poverty|Grades PreK-2|                      30.00|                                459.36|                                540.42|              18|                                f|                         f| 2014-05-11|\n|2ab3efb23acc84017...|5a497c425e05bb193...|ed170a147cd8ee239...| 261200001297|      42.422054|      -83.209656|      Detroit|          MI|     48235|       urban|Detroit Public Sc...|           Wayne|             t|            f|                f|          f|          f|                           f|           Ms.|                        f|                         f|             Literacy|Literacy &amp; Language|                   null|                null|   Technology|highest poverty|Grades PreK-2|                      30.00|                                325.39|                                382.81|              25|                                f|                         f| 2014-05-11|\n|3118962680bb06232...|eb0855cc6ea55d173...|71b4dee33799c2111...| 340264001386|      39.951767|      -75.117188|       Camden|          NJ|     08102|       urban|Camden City Schoo...|          Camden|             f|            f|                f|          f|          f|                           f|           Mr.|                        f|                         f| College &amp; Career ...|   Applied Learning|                   null|                null|   Technology|highest poverty|Grades PreK-2|                      30.00|                                567.84|                                668.05|              28|                                f|                         f| 2014-05-11|\n|ed758904cb855e09a...|dd468ba7670637c06...|25baeaff8836051c2...| 062271010879|      34.076739|     -118.304313|  Los Angeles|          CA|     90004|       urban|Los Angeles Unif ...|     Los Angeles|             f|            f|                f|          f|          f|                           f|          Mrs.|                        f|                         f|             Literacy|Literacy &amp; Language|        Social Sciences|    History &amp; Civics|        Other|   high poverty|   Grades 3-5|                      30.00|                                203.86|                                239.84|              30|                                f|                         f| 2014-05-11|\n|30eee62287c7a0df6...|e910131d9715a25f5...|37ba0fbd78fc9d882...| 370333001367|      34.196528|      -77.844691|   Wilmington|          NC|     28409|       urban|New Hanover Co Sc...|     New Hanover|             f|            f|                f|          f|          f|                           f|           Ms.|                        f|                         f|        Special Needs|      Special Needs|                   null|                null|   Technology|   high poverty|   Grades 3-5|                      30.00|                               1791.78|                               2107.98|              15|                                f|                         f| 2014-05-11|\n|16bc417657fbe7615...|68fbe2c09342d35fb...|c46204c24d4ee1416...| 180387002096|      41.613398|      -87.262466|         Gary|          IN|     46403|       urban|Gary Cmty School ...|            Lake|             f|            f|                f|          f|          f|                           f|          Mrs.|                        f|                         f|             Literacy|Literacy &amp; Language|            Mathematics|      Math &amp; Science|   Technology|highest poverty|Grades PreK-2|                      30.00|                                483.64|                                568.99|              22|                                f|                         f| 2014-05-11|\n|137cc8578133ac213...|4cda287dd1e78c9e7...|91e21558106c5bf6f...| 061551001971|      34.432667|     -119.794609|Santa Barbara|          CA|     93111|    suburban|Goleta Union Scho...|   Santa Barbara|             f|            f|                f|          f|          f|                           f|          Mrs.|                        f|                         f|             Literacy|Literacy &amp; Language|                   null|                null|        Other|   high poverty|   Grades 3-5|                      30.00|                                223.91|                                263.42|              30|                                f|                         f| 2014-05-11|\n|207f8821d991dbdcf...|07510353f060b8d6b...|d831571fe06ef207c...|         null|      40.636737|      -73.933625|     Brooklyn|          NY|     11203|        null|         District 75|Kings (Brooklyn)|             f|            f|                f|          f|          f|                           f|           Ms.|                        f|                         f| Literature &amp; Writing|Literacy &amp; Language|   Health &amp; Life Sci...|      Math &amp; Science|        Other|highest poverty|Grades PreK-2|                      30.00|                                478.47|                                562.91|               6|                                f|                         f| 2014-05-11|\n|222211704d0d75cd6...|20de53e5b4256f28e...|607ae9c77d36afe59...| 482406002670|      32.826298|      -97.169121|        Hurst|          TX|     76053|    suburban|Hurst-euless-bedf...|         Tarrant|             f|            f|                f|          f|          f|                           f|           Ms.|                        f|                         f|             Literacy|Literacy &amp; Language|                   null|                null|        Books|highest poverty|Grades PreK-2|                      30.00|                                429.29|                                505.05|              25|                                f|                         f| 2014-05-11|\n|cb4d4ecdc6f2f33c3...|2133fc46f951f1e7d...|4f12c3fa0c1cce823...| 360015302507|      40.641727|      -73.965655|     Brooklyn|          NY|     11226|       urban|New York City Dep...|Kings (Brooklyn)|             f|            t|                f|          f|          f|                           f|           Mr.|                        t|                         f|        Special Needs|      Special Needs|               Literacy| Literacy &amp; Language|        Other|highest poverty|   Grades 3-5|                      30.00|                                434.83|                                511.56|              12|                                f|                         f| 2014-05-11|\n|bdc35fa6476909d4c...|eab295825a5ef633b...|a893dc8a7eee40616...| 484095004655|      29.305878|      -98.671834|  San Antonio|          TX|     78252|       rural|Southwest Ind Sch...|           Bexar|             f|            f|                f|          f|          f|                           f|           Ms.|                        f|                         f|          Mathematics|     Math &amp; Science|               Literacy| Literacy &amp; Language|     Supplies|highest poverty|Grades PreK-2|                      30.00|                                415.54|                                488.87|              16|                                f|                         f| 2014-05-11|\n|dbb0371432d07b7e7...|71ff6cddcf7bd7d58...|253549b5752d520d3...| 063441005626|      37.753613|     -122.419875|San Francisco|          CA|     94110|       urban|San Francisco Uni...|   San Francisco|             f|            f|                f|          f|          f|                           f|           Ms.|                        f|                         f|     Applied Sciences|     Math &amp; Science|     Parent Involvement|    Applied Learning|   Technology|highest poverty|   Grades 3-5|                      30.00|                                459.27|                                540.32|             600|                                f|                         f| 2014-05-11|\n|93fdea4933f719d63...|1c7d7a8ea1cf05346...|ef07a4100aa841577...| 400951000409|      34.498756|      -97.116074|        Davis|          OK|     73030|       rural|Davis School Dist...|          Murray|             f|            f|                f|          f|          f|                           f|          Mrs.|                        f|                         f| Environmental Sci...|     Math &amp; Science|               Literacy| Literacy &amp; Language|   Technology|   high poverty|Grades PreK-2|                      30.00|                                412.23|                                484.98|             125|                                f|                         f| 2014-05-11|\n+--------------------+--------------------+--------------------+-------------+---------------+----------------+-------------+------------+----------+------------+--------------------+----------------+--------------+-------------+-----------------+-----------+-----------+----------------------------+--------------+-------------------------+--------------------------+---------------------+-------------------+-----------------------+--------------------+-------------+---------------+-------------+---------------------------+--------------------------------------+--------------------------------------+----------------+---------------------------------+--------------------------+-----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">notebook:1: error: not found: value projects\nprojects.show()\n^\n</div>","error":null,"workflows":[],"startTime":1524750368335,"submitTime":1524750368308,"finishTime":1524750370811,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a866925d-4968-4138-8ec0-56186a1682c5"},{"version":"CommandV1","origId":3413744942634571,"guid":"1de788eb-7759-4f92-bb3d-be96fc1f484b","subtype":"command","commandType":"auto","position":5.0,"command":"val resources=spark.read.format(\"csv\").option(\"header\", \"true\").load(\"/FileStore/tables/resources.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">resources: org.apache.spark.sql.DataFrame = [resourceid: string, projectid: string ... 7 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"resources","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"resourceid","type":"string","nullable":true,"metadata":{}},{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"vendorid","type":"string","nullable":true,"metadata":{}},{"name":"vendor_name","type":"string","nullable":true,"metadata":{}},{"name":"project_resource_type","type":"string","nullable":true,"metadata":{}},{"name":"item_name","type":"string","nullable":true,"metadata":{}},{"name":"item_number","type":"string","nullable":true,"metadata":{}},{"name":"item_unit_price","type":"string","nullable":true,"metadata":{}},{"name":"item_quantity","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750377869,"submitTime":1524750370865,"finishTime":1524750382321,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b14eb8f8-cb83-4d6e-9c4a-7419e72b4bd4"},{"version":"CommandV1","origId":3413744942634572,"guid":"1ef603ea-3c5d-4ec4-a8b3-aa24461bb62c","subtype":"command","commandType":"auto","position":6.0,"command":"resources.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+--------------------+--------+--------------------+---------------------+--------------------+-----------+---------------+-------------+\n|          resourceid|           projectid|vendorid|         vendor_name|project_resource_type|           item_name|item_number|item_unit_price|item_quantity|\n+--------------------+--------------------+--------+--------------------+---------------------+--------------------+-----------+---------------+-------------+\n|8a1c1c45bc30d0650...|ffffc4f85b60efc5b...|     430|Woodwind and Bras...|           Technology|iPod nano 4th Gen...| 249995.001|            149|            4|\n|015d2c4935c504279...|ffffac55ee02a49d1...|      82|Best Buy for Busi...|           Technology|Sony bloggie MHS-...| BB11216668|            148|            1|\n|26a02944b2f0c25f9...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|VX748 - Best-Buy ...|      VX748|          69.95|            1|\n|7fef1f92cb4447d18...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|LA138 - Best-Buy ...|      LA138|          34.95|            1|\n|8dccf77df25ee615b...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|BJ7471 - 1 1/2&amp;#3...|     BJ7471|          10.95|            4|\n|76ad6546da5113f03...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|NF9763 - White Se...|     NF9763|           3.99|            2|\n|f2293c48469eeedd1...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|HU18 - Electric P...|       HU18|          44.95|            1|\n|8b0a477c471f95507...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|GG297 - Behavior ...|      GG297|          19.95|            1|\n|aaabc2bfec809a6ee...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|LC1561 - Sentence...|     LC1561|           6.95|            1|\n|dc122690989bb55bc...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|TT991 - Lakeshore...|      TT991|          29.95|            1|\n|e32a4c9fdc6f146af...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|TT992 - Refill Pa...|      TT992|           1.95|            1|\n|95c3fe3cfa65f7a94...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|EE211 - The Every...|      EE211|          12.99|            1|\n|82656e66939882fbd...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|TA3385 - Unruled ...|     TA3385|          16.95|            2|\n|99582d64aa1bdac35...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|DD139 - Big Coin ...|      DD139|           4.99|            2|\n|562cf7f2602115339...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|WS158 - Write &amp; W...|      WS158|           5.49|            2|\n|9ea30dbd4aca954ab...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|BJ7461 - 1&amp;#34; R...|     BJ7461|          10.95|            4|\n|65befe3daaa558210...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|NF9765 - Rainbow ...|     NF9765|           4.99|            3|\n|84dc9090ed40b5b92...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|AA349 - Teacher&amp;#...|      AA349|           4.99|            1|\n|afed6dd01dab8d7ef...|ffff97ed93720407d...|     767|Lakeshore Learnin...|             Supplies|NF9767 - Mini Rai...|     NF9767|           3.49|            2|\n|15d2e9b318d24d0bb...|ffff7266778f71242...|      47|Scholastic Classr...|                Other|Let's Find Out, K...|          8|           5.25|           25|\n+--------------------+--------------------+--------+--------------------+---------------------+--------------------+-----------+---------------+-------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750382334,"submitTime":1524750371705,"finishTime":1524750385605,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"21056968-8551-4945-8254-4c8792ab1819"},{"version":"CommandV1","origId":3413744942634573,"guid":"eaefb200-9240-4ccc-b693-08b93fe0a019","subtype":"command","commandType":"auto","position":7.0,"command":"val  outcomes = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"/FileStore/tables/outcomes.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">outcomes: org.apache.spark.sql.DataFrame = [projectid: string, is_exciting: string ... 10 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outcomes","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":true,"metadata":{}},{"name":"at_least_1_teacher_referred_donor","type":"string","nullable":true,"metadata":{}},{"name":"fully_funded","type":"string","nullable":true,"metadata":{}},{"name":"at_least_1_green_donation","type":"string","nullable":true,"metadata":{}},{"name":"great_chat","type":"string","nullable":true,"metadata":{}},{"name":"three_or_more_non_teacher_referred_donors","type":"string","nullable":true,"metadata":{}},{"name":"one_non_teacher_referred_donor_giving_100_plus","type":"string","nullable":true,"metadata":{}},{"name":"donation_from_thoughtful_donor","type":"string","nullable":true,"metadata":{}},{"name":"great_messages_proportion","type":"string","nullable":true,"metadata":{}},{"name":"teacher_referred_count","type":"string","nullable":true,"metadata":{}},{"name":"non_teacher_referred_count","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750385631,"submitTime":1524750372117,"finishTime":1524750387079,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3824a4d6-d005-48f3-b983-26c2410c4a19"},{"version":"CommandV1","origId":3413744942634574,"guid":"5c026a62-936b-47a4-be91-6c489697b0d2","subtype":"command","commandType":"auto","position":8.0,"command":"outcomes.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+-----------+---------------------------------+------------+-------------------------+----------+-----------------------------------------+----------------------------------------------+------------------------------+-------------------------+----------------------+--------------------------+\n|           projectid|is_exciting|at_least_1_teacher_referred_donor|fully_funded|at_least_1_green_donation|great_chat|three_or_more_non_teacher_referred_donors|one_non_teacher_referred_donor_giving_100_plus|donation_from_thoughtful_donor|great_messages_proportion|teacher_referred_count|non_teacher_referred_count|\n+--------------------+-----------+---------------------------------+------------+-------------------------+----------+-----------------------------------------+----------------------------------------------+------------------------------+-------------------------+----------------------+--------------------------+\n|ffffc4f85b60efc5b...|          f|                             null|           f|                     null|         f|                                     null|                                          null|                          null|                     null|                  null|                      null|\n|ffffac55ee02a49d1...|          f|                                f|           t|                        t|         f|                                        t|                                             f|                             f|                     57.0|                   0.0|                       7.0|\n|ffff97ed93720407d...|          f|                                f|           t|                        t|         t|                                        t|                                             t|                             f|                    100.0|                   0.0|                       3.0|\n|ffff418bb42fad243...|          f|                                f|           f|                        t|         t|                                        f|                                             f|                             f|                    100.0|                   0.0|                       1.0|\n|ffff2d9c769c8fb53...|          t|                                t|           t|                        t|         t|                                        f|                                             t|                             f|                     63.0|                   6.0|                       2.0|\n|fffeebf4827d745aa...|          f|                                f|           t|                        f|         f|                                        f|                                             t|                             f|                      0.0|                   0.0|                       1.0|\n|fffee68353ade53e7...|          f|                                f|           f|                        f|         f|                                        f|                                             f|                             f|                      0.0|                   0.0|                       2.0|\n|fffec078a2249c236...|          f|                                f|           t|                        f|         f|                                        f|                                             t|                             f|                     null|                   0.0|                       1.0|\n|fffeb149cd9b85d80...|          f|                                f|           t|                        f|         f|                                        f|                                             t|                             f|                     null|                   0.0|                       1.0|\n|fffeaae9482c9b72c...|          f|                                f|           f|                        f|         f|                                        f|                                             f|                             f|                      0.0|                   0.0|                       1.0|\n|fffe700e315373fc1...|          f|                             null|           f|                     null|         f|                                     null|                                          null|                          null|                     null|                  null|                      null|\n|fffe598a41270538e...|          f|                                f|           t|                        t|         f|                                        t|                                             f|                             f|                     60.0|                   0.0|                      10.0|\n|fffe45b28ea6f2889...|          f|                                f|           t|                        t|         t|                                        t|                                             t|                             f|                     80.0|                   0.0|                      10.0|\n|fffe426c60834b0ba...|          f|                                f|           t|                        t|         f|                                        t|                                             t|                             f|                     null|                   0.0|                       4.0|\n|fffe0bb8af3b9cd93...|          t|                                t|           t|                        t|         t|                                        t|                                             t|                             f|                    100.0|                   1.0|                       5.0|\n|fffe0476e16862c48...|          f|                                f|           t|                        f|         f|                                        f|                                             f|                             f|                      0.0|                   0.0|                       1.0|\n|fffdfdcf27588d2d3...|          f|                             null|           f|                     null|         f|                                     null|                                          null|                          null|                     null|                  null|                      null|\n|fffdfafaf7cc8fdd9...|          f|                                f|           t|                        f|         f|                                        f|                                             t|                             f|                      0.0|                   0.0|                       1.0|\n|fffdf9d286e715165...|          f|                                f|           t|                        t|         t|                                        t|                                             t|                             f|                     66.0|                   0.0|                       5.0|\n|fffda9a35e156656d...|          f|                                f|           t|                        f|         f|                                        f|                                             t|                             f|                      0.0|                   0.0|                       2.0|\n+--------------------+-----------+---------------------------------+------------+-------------------------+----------+-----------------------------------------+----------------------------------------------+------------------------------+-------------------------+----------------------+--------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750387114,"submitTime":1524750372607,"finishTime":1524750388448,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0777649e-e5d0-4035-ade7-434be446c7fe"},{"version":"CommandV1","origId":3413744942634575,"guid":"8d83eda6-e5bb-45e1-afdf-540f4cd121c3","subtype":"command","commandType":"auto","position":9.0,"command":"val essays = spark.read.format(\"csv\").option(\"header\", \"true\").option(\"multiLine\", true).load(\"/FileStore/tables/essays.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">essays: org.apache.spark.sql.DataFrame = [projectid: string, teacher_acctid: string ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"essays","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"teacher_acctid","type":"string","nullable":true,"metadata":{}},{"name":"title","type":"string","nullable":true,"metadata":{}},{"name":"short_description","type":"string","nullable":true,"metadata":{}},{"name":"need_statement","type":"string","nullable":true,"metadata":{}},{"name":"essay","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:5: error: unclosed character literal\nval essays = spark.read.format(&quot;csv&quot;).option(header='true', nullValue='null', treatEmptyValuesAsNulls = 'true', ).load(&quot;/FileStore/tables/essays.csv&quot;)\n                                                         ^\n&lt;console&gt;:5: error: unclosed character literal\nval essays = spark.read.format(&quot;csv&quot;).option(header='true', nullValue='null', treatEmptyValuesAsNulls = 'true', ).load(&quot;/FileStore/tables/essays.csv&quot;)\n                                                                           ^\n&lt;console&gt;:5: error: unclosed character literal\nval essays = spark.read.format(&quot;csv&quot;).option(header='true', nullValue='null', treatEmptyValuesAsNulls = 'true', ).load(&quot;/FileStore/tables/essays.csv&quot;)\n                                                                                                             ^\n</div>","error":null,"workflows":[],"startTime":1524750388459,"submitTime":1524750372958,"finishTime":1524750389711,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d27b5404-453e-4b43-b006-13960fd210b4"},{"version":"CommandV1","origId":272706934037281,"guid":"007c21a5-9cf1-4394-ac8c-406990c4c580","subtype":"command","commandType":"auto","position":9.5,"command":"essays.select(\"essay\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+\n|               essay|\n+--------------------+\n|I am a fourth yea...|\n|Can you imagine h...|\n|Hi. I teach a won...|\n|&quot;My Kindergarten ...|\n|All work and no p...|\n|&quot;Have you ever ha...|\n|The rewards of pl...|\n|&quot;My students enjo...|\n|                 300|\n|            &quot;&quot;Tell&quot;&quot;|\n|I teach 3rd grade...|\n| &quot;&quot;Alphabet Under...|\n|We are a fourth g...|\n|&quot;My students love...|\n|The glockenspiel ...|\n|Fifty per cent of...|\n|Do you know what ...|\n|As Common Core is...|\n|&quot;Do you remember ...|\n|Save us from a li...|\n+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">notebook:1: error: value selector is not a member of org.apache.spark.sql.DataFrame\nessays.selector(&quot;essay&quot;).show()\n       ^\n</div>","error":null,"workflows":[],"startTime":1524750389722,"submitTime":1524750373263,"finishTime":1524750422041,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc2a13c2-b4c2-4939-9e52-11b2f598bcb0"},{"version":"CommandV1","origId":4186973666342071,"guid":"71a1567a-9515-4f82-8eef-d3fdb063ae19","subtype":"command","commandType":"auto","position":9.625,"command":"val Array(essay1, essay2) = essays.randomSplit(Array(0.01, 0.99))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">essay1: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [projectid: string, teacher_acctid: string ... 4 more fields]\nessay2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [projectid: string, teacher_acctid: string ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"essay1","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"teacher_acctid","type":"string","nullable":true,"metadata":{}},{"name":"title","type":"string","nullable":true,"metadata":{}},{"name":"short_description","type":"string","nullable":true,"metadata":{}},{"name":"need_statement","type":"string","nullable":true,"metadata":{}},{"name":"essay","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"essay2","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"teacher_acctid","type":"string","nullable":true,"metadata":{}},{"name":"title","type":"string","nullable":true,"metadata":{}},{"name":"short_description","type":"string","nullable":true,"metadata":{}},{"name":"need_statement","type":"string","nullable":true,"metadata":{}},{"name":"essay","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524758018664,"submitTime":1524758018631,"finishTime":1524758019075,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"34658fac-8dd8-4d77-8e42-20ed5eaa2344"},{"version":"CommandV1","origId":272706934037283,"guid":"dfb8d0ef-133f-45f8-bb6a-1023b9a7fa20","subtype":"command","commandType":"auto","position":9.75,"command":"import org.apache.spark.ml.feature.{HashingTF, IDF, Tokenizer}\nval tokenizer = new Tokenizer().setInputCol(\"essay\").setOutputCol(\"words\") \nval wordsData = tokenizer.transform(essay1)\nwordsData.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|           projectid|      teacher_acctid|               title|   short_description|      need_statement|               essay|               words|\n+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|000a460280d4876a4...|89e8889cd39cccf9f...|Operation: Learni...|&quot;Learning is not ...|My students need ...|&quot;Learning is not ...|[&quot;learning, is, n...|\n|001884eabcc49e663...|28c40c441bb25a31f...|Books For the Lov...|I am going to be ...|The cost of three...|I am going to be ...|[i, am, going, to...|\n|001c87f75f9059a50...|ec536a2c35934cebb...|Tracing Trade Tod...|One can only imag...|&quot;The cost of a bu...|                 300|             [, 300]|\n|002593737c2fd419f...|cc476ff77b66cac52...|Cozy Learning Cud...|&quot;So please, oh PL...| Charlie and The ...|My students need ...|[my, students, ne...|\n|0025aca515b9609be...|94b2417628442e9c8...|A Shocking Experi...|A Van De Graaff g...|My students need ...|I teach Physical ...|[i, teach, physic...|\n|002ac04b959e8d96e...|cd1854ecb78d149a3...|     iDifferentiate!|My classroom is F...|My students need ...|My classroom is F...|[my, classroom, i...|\n|002c4695da51dd385...|594492c8b3b625175...|        Math Matters|I am requesting m...|My students need ...|Math is so diffic...|[math, is, so, di...|\n|003e1b3d2f7936ac6...|45c27a90a67d77c6e...|More Board=Less B...|I want them to us...|My students need ...|We want to show w...|[we, want, to, sh...|\n|004e817c45dcc44e8...|71bca9b7958e08018...|Reading And Math ...|I want to prepare...|My students need ...|I want to prepare...|[i, want, to, pre...|\n|00514e04334da061a...|6206e3871b05ddd2d...|We Can Read With ...|Reading is a skil...|My students need ...|When I started te...|[when, i, started...|\n|005303e021a5ff201...|334166186c2ef160e...|The Powerful Test...|My desire to expo...|The cost of books...|&quot;I am a third gra...|[&quot;i, am, a, third...|\n|005fc957e6a5fcaa4...|7ddd2a9b4d1ba4268...|Pointillist Pictures|I like to provide...|My students need ...|I like to provide...|[i, like, to, pro...|\n|00666339ccb86db29...|82ee2eb931e212dfb...|Reaching All Readers|With these leveli...|My students need ...|My challenge is m...|[my, challenge, i...|\n|006d8331a801e0c83...|6d5ce11cdd7d0d4de...|A Cutting Edge Ed...|This computer wil...|My students need ...|This year our sch...|[this, year, our,...|\n|006ec5f54b09f54fb...|29e124e36d2fb0a4c...|         Hoot! Hoot!|Do you remember s...|My students need ...|Do you remember s...|[do, you, remembe...|\n|0074de6b4a5e8df87...|9cf1a00f1f14780b4...|Clicking In Geometry|Do you remember w...|My students need ...|&quot;Do you remember ...|[&quot;do, you, rememb...|\n|0088c4769a10d3d53...|063e130c98f0d19e1...|Learning by Sitting!|Imagine 25 first ...|My students need ...|Imagine 25 first ...|[imagine, 25, fir...|\n|00951019a96b85d99...|02656ae5e9c2ddfa1...|iDance using an iPad|&quot;We believe that ...|My students need ...|&quot;We believe that ...|[&quot;we, believe, th...|\n|00982479d3dcf6bda...|821bee9cc2e227ec5...|Stepping Our Way ...|We are going to i...|My students need ...|I am a 6th Grade ...|[i, am, a, 6th, g...|\n|00cb2d012b3d3b174...|f1a851b7e8dc41281...|GoPro in PE! Tech...|My students LOVE ...|My students need ...|My students LOVE ...|[my, students, lo...|\n+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.{HashingTF, IDF, Tokenizer}\ntokenizer: org.apache.spark.ml.feature.Tokenizer = tok_1f1accfcc143\nwordsData: org.apache.spark.sql.DataFrame = [projectid: string, teacher_acctid: string ... 5 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"wordsData","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"teacher_acctid","type":"string","nullable":true,"metadata":{}},{"name":"title","type":"string","nullable":true,"metadata":{}},{"name":"short_description","type":"string","nullable":true,"metadata":{}},{"name":"need_statement","type":"string","nullable":true,"metadata":{}},{"name":"essay","type":"string","nullable":true,"metadata":{}},{"name":"words","type":{"type":"array","elementType":"string","containsNull":true},"nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524758027662,"submitTime":1524758027635,"finishTime":1524758052572,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b9750ad8-0dff-430b-8ef0-c42bff846df9"},{"version":"CommandV1","origId":272706934037284,"guid":"635f0fe6-b4d5-4627-906d-9132e755aa16","subtype":"command","commandType":"auto","position":9.875,"command":"val hashingTF = new org.apache.spark.ml.feature.HashingTF().setInputCol(\"words\").setOutputCol(\"rawFeatures\").setNumFeatures(100) \nval featurizedData = hashingTF.transform(wordsData)\nfeaturizedData.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|           projectid|      teacher_acctid|               title|   short_description|      need_statement|               essay|               words|         rawFeatures|\n+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|000a460280d4876a4...|89e8889cd39cccf9f...|Operation: Learni...|&quot;Learning is not ...|My students need ...|&quot;Learning is not ...|[&quot;learning, is, n...|(100,[1,2,3,4,10,...|\n|001884eabcc49e663...|28c40c441bb25a31f...|Books For the Lov...|I am going to be ...|The cost of three...|I am going to be ...|[i, am, going, to...|(100,[0,4,5,9,10,...|\n|001c87f75f9059a50...|ec536a2c35934cebb...|Tracing Trade Tod...|One can only imag...|&quot;The cost of a bu...|                 300|             [, 300]|(100,[48,72],[1.0...|\n|002593737c2fd419f...|cc476ff77b66cac52...|Cozy Learning Cud...|&quot;So please, oh PL...| Charlie and The ...|My students need ...|[my, students, ne...|(100,[16,23,26,28...|\n|0025aca515b9609be...|94b2417628442e9c8...|A Shocking Experi...|A Van De Graaff g...|My students need ...|I teach Physical ...|[i, teach, physic...|(100,[0,2,4,5,7,9...|\n|002ac04b959e8d96e...|cd1854ecb78d149a3...|     iDifferentiate!|My classroom is F...|My students need ...|My classroom is F...|[my, classroom, i...|(100,[0,1,2,5,6,7...|\n|002c4695da51dd385...|594492c8b3b625175...|        Math Matters|I am requesting m...|My students need ...|Math is so diffic...|[math, is, so, di...|(100,[0,3,4,5,10,...|\n|003e1b3d2f7936ac6...|45c27a90a67d77c6e...|More Board=Less B...|I want them to us...|My students need ...|We want to show w...|[we, want, to, sh...|(100,[0,1,4,7,8,9...|\n|004e817c45dcc44e8...|71bca9b7958e08018...|Reading And Math ...|I want to prepare...|My students need ...|I want to prepare...|[i, want, to, pre...|(100,[2,4,5,6,7,8...|\n|00514e04334da061a...|6206e3871b05ddd2d...|We Can Read With ...|Reading is a skil...|My students need ...|When I started te...|[when, i, started...|(100,[2,4,6,8,10,...|\n|005303e021a5ff201...|334166186c2ef160e...|The Powerful Test...|My desire to expo...|The cost of books...|&quot;I am a third gra...|[&quot;i, am, a, third...|(100,[0,1,4,5,6,8...|\n|005fc957e6a5fcaa4...|7ddd2a9b4d1ba4268...|Pointillist Pictures|I like to provide...|My students need ...|I like to provide...|[i, like, to, pro...|(100,[0,1,3,4,5,6...|\n|00666339ccb86db29...|82ee2eb931e212dfb...|Reaching All Readers|With these leveli...|My students need ...|My challenge is m...|[my, challenge, i...|(100,[0,1,4,5,7,9...|\n|006d8331a801e0c83...|6d5ce11cdd7d0d4de...|A Cutting Edge Ed...|This computer wil...|My students need ...|This year our sch...|[this, year, our,...|(100,[0,1,2,4,8,1...|\n|006ec5f54b09f54fb...|29e124e36d2fb0a4c...|         Hoot! Hoot!|Do you remember s...|My students need ...|Do you remember s...|[do, you, remembe...|(100,[0,4,5,7,8,9...|\n|0074de6b4a5e8df87...|9cf1a00f1f14780b4...|Clicking In Geometry|Do you remember w...|My students need ...|&quot;Do you remember ...|[&quot;do, you, rememb...|(100,[0,2,6,7,8,9...|\n|0088c4769a10d3d53...|063e130c98f0d19e1...|Learning by Sitting!|Imagine 25 first ...|My students need ...|Imagine 25 first ...|[imagine, 25, fir...|(100,[0,1,2,3,4,5...|\n|00951019a96b85d99...|02656ae5e9c2ddfa1...|iDance using an iPad|&quot;We believe that ...|My students need ...|&quot;We believe that ...|[&quot;we, believe, th...|(100,[0,4,10,11,1...|\n|00982479d3dcf6bda...|821bee9cc2e227ec5...|Stepping Our Way ...|We are going to i...|My students need ...|I am a 6th Grade ...|[i, am, a, 6th, g...|(100,[1,4,9,10,11...|\n|00cb2d012b3d3b174...|f1a851b7e8dc41281...|GoPro in PE! Tech...|My students LOVE ...|My students need ...|My students LOVE ...|[my, students, lo...|(100,[0,4,5,10,12...|\n+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\nhashingTF: org.apache.spark.ml.feature.HashingTF = hashingTF_25d9ee31ac37\nfeaturizedData: org.apache.spark.sql.DataFrame = [projectid: string, teacher_acctid: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"featurizedData","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"teacher_acctid","type":"string","nullable":true,"metadata":{}},{"name":"title","type":"string","nullable":true,"metadata":{}},{"name":"short_description","type":"string","nullable":true,"metadata":{}},{"name":"need_statement","type":"string","nullable":true,"metadata":{}},{"name":"essay","type":"string","nullable":true,"metadata":{}},{"name":"words","type":{"type":"array","elementType":"string","containsNull":true},"nullable":true,"metadata":{}},{"name":"rawFeatures","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"num_attrs":100}}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524758059141,"submitTime":1524758059112,"finishTime":1524758082865,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b2a0de48-a902-4236-af71-a3f4f787a938"},{"version":"CommandV1","origId":272706934037285,"guid":"f9681513-0659-40c9-9dbf-348781f4e486","subtype":"command","commandType":"auto","position":9.9375,"command":"val idf = new IDF().setInputCol(\"rawFeatures\").setOutputCol(\"features\") \nval idfModel = idf.fit(featurizedData)\nval rescaledData = idfModel.transform(featurizedData) ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">idf: org.apache.spark.ml.feature.IDF = idf_136c737e3e53\nidfModel: org.apache.spark.ml.feature.IDFModel = idf_136c737e3e53\nrescaledData: org.apache.spark.sql.DataFrame = [projectid: string, teacher_acctid: string ... 7 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"rescaledData","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"teacher_acctid","type":"string","nullable":true,"metadata":{}},{"name":"title","type":"string","nullable":true,"metadata":{}},{"name":"short_description","type":"string","nullable":true,"metadata":{}},{"name":"need_statement","type":"string","nullable":true,"metadata":{}},{"name":"essay","type":"string","nullable":true,"metadata":{}},{"name":"words","type":{"type":"array","elementType":"string","containsNull":true},"nullable":true,"metadata":{}},{"name":"rawFeatures","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"num_attrs":100}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 24.0 failed 1 times, most recent failure: Lost task 0.0 in stage 24.0 (TID 258, localhost, executor driver): org.apache.spark.SparkException: Failed to execute user defined function($anonfun$createTransformFunc$1: (string) => array<string>)","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:893)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1336)\n\tat scala.collection.TraversableOnce$class.foldLeft(TraversableOnce.scala:157)\n\tat scala.collection.AbstractIterator.foldLeft(Iterator.scala:1336)\n\tat scala.collection.TraversableOnce$class.aggregate(TraversableOnce.scala:214)\n\tat scala.collection.AbstractIterator.aggregate(Iterator.scala:1336)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$23.apply(RDD.scala:1147)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$23.apply(RDD.scala:1147)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$24.apply(RDD.scala:1148)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$24.apply(RDD.scala:1148)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:808)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:808)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:111)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:350)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.lang.NullPointerException\n\tat org.apache.spark.ml.feature.Tokenizer$$anonfun$createTransformFunc$1.apply(Tokenizer.scala:39)\n\tat org.apache.spark.ml.feature.Tokenizer$$anonfun$createTransformFunc$1.apply(Tokenizer.scala:39)\n\t... 27 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1718)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1706)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1705)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1705)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:943)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:943)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:943)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1941)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1889)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1877)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:740)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2109)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2206)\n\tat org.apache.spark.rdd.RDD$$anonfun$fold$1.apply(RDD.scala:1100)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:371)\n\tat org.apache.spark.rdd.RDD.fold(RDD.scala:1094)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1.apply(RDD.scala:1163)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:371)\n\tat org.apache.spark.rdd.RDD.treeAggregate(RDD.scala:1139)\n\tat org.apache.spark.mllib.feature.IDF.fit(IDF.scala:54)\n\tat org.apache.spark.ml.feature.IDF.fit(IDF.scala:92)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-272706934037285:2)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-272706934037285:64)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-272706934037285:66)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-272706934037285:68)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-272706934037285:70)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw$$iw$$iw.&lt;init&gt;(command-272706934037285:72)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw$$iw.&lt;init&gt;(command-272706934037285:74)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$$iw.&lt;init&gt;(command-272706934037285:76)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read.&lt;init&gt;(command-272706934037285:78)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$.&lt;init&gt;(command-272706934037285:82)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$read$.&lt;clinit&gt;(command-272706934037285)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$eval$.$print(&lt;notebook&gt;:6)\n\tat linea86bdf41a1fb477bbdfc6689fac2b05396.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:500)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:249)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:229)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:43)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:229)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.SparkException: Failed to execute user defined function($anonfun$createTransformFunc$1: (string) =&gt; array&lt;string&gt;)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:893)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1336)\n\tat scala.collection.TraversableOnce$class.foldLeft(TraversableOnce.scala:157)\n\tat scala.collection.AbstractIterator.foldLeft(Iterator.scala:1336)\n\tat scala.collection.TraversableOnce$class.aggregate(TraversableOnce.scala:214)\n\tat scala.collection.AbstractIterator.aggregate(Iterator.scala:1336)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$23.apply(RDD.scala:1147)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$23.apply(RDD.scala:1147)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$24.apply(RDD.scala:1148)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$24.apply(RDD.scala:1148)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:808)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:808)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:111)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:350)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.lang.NullPointerException\n\tat org.apache.spark.ml.feature.Tokenizer$$anonfun$createTransformFunc$1.apply(Tokenizer.scala:39)\n\tat org.apache.spark.ml.feature.Tokenizer$$anonfun$createTransformFunc$1.apply(Tokenizer.scala:39)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:893)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1336)\n\tat scala.collection.TraversableOnce$class.foldLeft(TraversableOnce.scala:157)\n\tat scala.collection.AbstractIterator.foldLeft(Iterator.scala:1336)\n\tat scala.collection.TraversableOnce$class.aggregate(TraversableOnce.scala:214)\n\tat scala.collection.AbstractIterator.aggregate(Iterator.scala:1336)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$23.apply(RDD.scala:1147)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$23.apply(RDD.scala:1147)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$24.apply(RDD.scala:1148)\n\tat org.apache.spark.rdd.RDD$$anonfun$treeAggregate$1$$anonfun$24.apply(RDD.scala:1148)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:808)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:808)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:332)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:296)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:111)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:350)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1524758088535,"submitTime":1524758088507,"finishTime":1524758115002,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"746e8082-20aa-4815-8e8e-ccc265d81ab0"},{"version":"CommandV1","origId":3413744942634576,"guid":"85fd002e-e1a0-4ad3-a420-27424d09f5e8","subtype":"command","commandType":"auto","position":10.0,"command":"projects.createOrReplaceTempView(\"p\");\noutcomes.createOrReplaceTempView(\"o\");","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">notebook:2: error: not enough arguments for method registerTempTable: (tableName: String)Unit.\nUnspecified value parameter tableName.\noutcomes.registerTempTable();\n                          ^\nnotebook:1: error: not enough arguments for method registerTempTable: (tableName: String)Unit.\nUnspecified value parameter tableName.\nprojects.registerTempTable();\n                          ^\n</div>","error":null,"workflows":[],"startTime":1524750611947,"submitTime":1524750611920,"finishTime":1524750612262,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3b83a54-dd36-4e1d-baa9-d5e81dd8e576"},{"version":"CommandV1","origId":3413744942634578,"guid":"38cb8e76-dce0-4b17-a381-b765dcd5c919","subtype":"command","commandType":"auto","position":11.0,"command":"val sqlDF = spark.sql(\"select p.projectid, p.school_state, p.school_charter, p.teacher_prefix, p.poverty_level, p.date_posted, p.school_metro, p.school_charter, p.school_magnet, p.school_year_round, p.grade_level, p.fulfillment_labor_materials, o.is_exciting from p join o on p.projectid=o.projectid\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">sqlDF: org.apache.spark.sql.DataFrame = [projectid: string, school_state: string ... 11 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"sqlDF","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"date_posted","type":"string","nullable":true,"metadata":{}},{"name":"school_metro","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"string","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":"org.apache.spark.sql.AnalysisException: Reference 'projectid' is ambiguous, could be: p.projectid, o.projectid.; line 1 pos 31","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolve(LogicalPlan.scala:214)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveChildren(LogicalPlan.scala:98)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$38.apply(Analyzer.scala:832)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$38.apply(Analyzer.scala:834)\n\tat org.apache.spark.sql.catalyst.analysis.package$.withPosition(package.scala:48)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$resolve(Analyzer.scala:831)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9$$anonfun$applyOrElse$38.apply(Analyzer.scala:910)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9$$anonfun$applyOrElse$38.apply(Analyzer.scala:910)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:107)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:117)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:118)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$1.apply(QueryPlan.scala:126)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:208)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.mapExpressions(QueryPlan.scala:126)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9.applyOrElse(Analyzer.scala:910)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9.applyOrElse(Analyzer.scala:843)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$6.apply(TreeNode.scala:312)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$6.apply(TreeNode.scala:312)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:77)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:311)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:309)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:309)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$8.apply(TreeNode.scala:331)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:208)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:329)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:309)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:843)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:698)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:87)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:84)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:124)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:76)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:76)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:130)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:124)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:109)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:76)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:66)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:77)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:639)\n\tat line07194733578648849550ea799397a91a68.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3413744942634578:1)\n\tat line07194733578648849550ea799397a91a68.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3413744942634578:44)\n\tat line07194733578648849550ea799397a91a68.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3413744942634578:46)\n\tat line07194733578648849550ea799397a91a68.$read$$iw$$iw$$iw.&lt;init&gt;(command-3413744942634578:48)\n\tat line07194733578648849550ea799397a91a68.$read$$iw$$iw.&lt;init&gt;(command-3413744942634578:50)\n\tat line07194733578648849550ea799397a91a68.$read$$iw.&lt;init&gt;(command-3413744942634578:52)\n\tat line07194733578648849550ea799397a91a68.$read.&lt;init&gt;(command-3413744942634578:54)\n\tat line07194733578648849550ea799397a91a68.$read$.&lt;init&gt;(command-3413744942634578:58)\n\tat line07194733578648849550ea799397a91a68.$read$.&lt;clinit&gt;(command-3413744942634578)\n\tat line07194733578648849550ea799397a91a68.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat line07194733578648849550ea799397a91a68.$eval$.$print(&lt;notebook&gt;:6)\n\tat line07194733578648849550ea799397a91a68.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:500)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:249)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:229)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:43)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:229)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1524750613564,"submitTime":1524750613537,"finishTime":1524750613978,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"26eed09c-ace4-49b0-a799-d42de212daf1"},{"version":"CommandV1","origId":272706934037280,"guid":"70e31359-62c5-4a99-bbed-dc2c5ab4a22e","subtype":"command","commandType":"auto","position":11.5,"command":"sqlDF.select(\"fulfillment_labor_materials\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------------------------+\n|fulfillment_labor_materials|\n+---------------------------+\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n|                      30.00|\n+---------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750615522,"submitTime":1524750615494,"finishTime":1524750618896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1c0988bd-6c5d-4578-abfb-9e11231479a5"},{"version":"CommandV1","origId":2575927416221270,"guid":"da06bcf0-70a6-49a7-8aa8-ec6e0b537406","subtype":"command","commandType":"auto","position":12.0,"command":"import org.apache.spark.sql.functions._\nimport org.apache.spark.sql.DataFrameNaFunctions\n\nval sqlDF1=sqlDF.filter(to_date(sqlDF(\"date_posted\")).gt(lit(\"2011-01-01\"))) \n\nval sqlDF2 = sqlDF1.na.fill(\"f\", Seq(\"is_exciting\"))\n\nsqlDF2.select(\"is_exciting\").describe().show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+-----------+\n|summary|is_exciting|\n+-------+-----------+\n|  count|     352790|\n|   mean|       null|\n| stddev|       null|\n|    min|          f|\n|    max|          t|\n+-------+-----------+\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.DataFrameNaFunctions\nsqlDF1: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [projectid: string, school_state: string ... 11 more fields]\nsqlDF2: org.apache.spark.sql.DataFrame = [projectid: string, school_state: string ... 11 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"sqlDF1","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"date_posted","type":"string","nullable":true,"metadata":{}},{"name":"school_metro","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"string","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"sqlDF2","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"projectid","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"date_posted","type":"string","nullable":true,"metadata":{}},{"name":"school_metro","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"string","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":"org.apache.spark.sql.AnalysisException: Cannot resolve column name \"date_posted\" among (projectid, school_state, school_charter, teacher_prefix, poverty_level, is_exciting);","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.Dataset$$anonfun$resolve$1.apply(Dataset.scala:226)\n\tat org.apache.spark.sql.Dataset$$anonfun$resolve$1.apply(Dataset.scala:226)\n\tat scala.Option.getOrElse(Option.scala:121)\n\tat org.apache.spark.sql.Dataset.resolve(Dataset.scala:225)\n\tat org.apache.spark.sql.Dataset.col(Dataset.scala:1245)\n\tat org.apache.spark.sql.Dataset.apply(Dataset.scala:1212)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:4)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:88)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:90)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:92)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:94)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:96)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:98)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:100)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:102)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:104)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:106)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:108)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:110)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:112)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:114)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:116)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:118)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221270:120)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw$$iw.&lt;init&gt;(command-2575927416221270:122)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$$iw.&lt;init&gt;(command-2575927416221270:124)\n\tat linea67f3864b5294f538719c89f8923161f148.$read.&lt;init&gt;(command-2575927416221270:126)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$.&lt;init&gt;(command-2575927416221270:130)\n\tat linea67f3864b5294f538719c89f8923161f148.$read$.&lt;clinit&gt;(command-2575927416221270)\n\tat linea67f3864b5294f538719c89f8923161f148.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linea67f3864b5294f538719c89f8923161f148.$eval$.$print(&lt;notebook&gt;:6)\n\tat linea67f3864b5294f538719c89f8923161f148.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:500)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:249)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:229)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:43)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:229)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1524750618902,"submitTime":1524750618091,"finishTime":1524750627393,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3d51174f-167f-4cd8-9915-50eb345f2a79"},{"version":"CommandV1","origId":2154212075512022,"guid":"bb908561-d940-476f-b001-a9b0b137bf93","subtype":"command","commandType":"auto","position":12.5,"command":"sqlDF2.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+------------+--------------+--------------+----------------+-----------+------------+--------------+-------------+-----------------+-------------+---------------------------+-----------+\n|           projectid|school_state|school_charter|teacher_prefix|   poverty_level|date_posted|school_metro|school_charter|school_magnet|school_year_round|  grade_level|fulfillment_labor_materials|is_exciting|\n+--------------------+------------+--------------+--------------+----------------+-----------+------------+--------------+-------------+-----------------+-------------+---------------------------+-----------+\n|62526d85d2a181843...|          IL|             f|          Mrs.|moderate poverty| 2013-12-31|    suburban|             f|            f|                f|   Grades 3-5|                      30.00|          f|\n|33d59ac771b80222a...|          ID|             f|          Mrs.|    high poverty| 2013-12-31|       urban|             f|            f|                f|   Grades 3-5|                      30.00|          f|\n|1a3aaeffc56dd2a42...|          NH|             f|          Mrs.|moderate poverty| 2013-12-31|    suburban|             f|            f|                f|   Grades 6-8|                      30.00|          f|\n|33aa19ee4da4c5adf...|          VA|             f|           Ms.| highest poverty| 2013-12-31|       urban|             f|            f|                f|Grades PreK-2|                      30.00|          f|\n|e31c0ea8b68f40469...|          IL|             f|           Mr.| highest poverty| 2013-12-31|       urban|             f|            t|                f|   Grades 6-8|                      30.00|          f|\n|c685c844476d7ed75...|          SC|             f|          Mrs.|    high poverty| 2013-12-31|       urban|             f|            f|                f|Grades PreK-2|                      30.00|          f|\n|a4b234feb2b72921e...|          KY|             f|          Mrs.| highest poverty| 2013-12-31|       urban|             f|            t|                t|Grades PreK-2|                      30.00|          f|\n|0ff5dec32bf793243...|          FL|             f|           Ms.| highest poverty| 2013-12-31|       rural|             f|            f|                f|Grades PreK-2|                      30.00|          f|\n|8cdbc04c8ee2ae6af...|          FL|             t|          Mrs.| highest poverty| 2013-12-31|       urban|             t|            f|                f|Grades PreK-2|                      30.00|          f|\n|72d58b8e22adbe6e6...|          WY|             f|          Mrs.|moderate poverty| 2013-12-31|       rural|             f|            f|                f|Grades PreK-2|                      30.00|          t|\n|1f405ea5b8ae8935a...|          NY|             f|           Ms.| highest poverty| 2013-12-31|       urban|             f|            f|                f|   Grades 3-5|                      30.00|          f|\n|c83d0794e67ec95f6...|          FL|             f|          Mrs.|    high poverty| 2013-12-31|    suburban|             f|            f|                f|   Grades 3-5|                      30.00|          f|\n|3b6bddd1df0e31006...|          NM|             f|          Mrs.| highest poverty| 2013-12-31|       urban|             f|            f|                f|  Grades 9-12|                      30.00|          f|\n|0f878f78e29665361...|          NC|             f|          Mrs.| highest poverty| 2013-12-31|       urban|             f|            f|                f|Grades PreK-2|                      30.00|          f|\n|301b1da14667351b1...|          AZ|             f|           Ms.|    high poverty| 2013-12-31|        null|             f|            f|                t|Grades PreK-2|                      30.00|          f|\n|9470f32d62e450ce0...|          MI|             t|           Ms.|    high poverty| 2013-12-31|       urban|             t|            f|                f|Grades PreK-2|                      30.00|          f|\n|1de851135e28ac7c5...|          MO|             f|           Ms.| highest poverty| 2013-12-31|    suburban|             f|            f|                f|Grades PreK-2|                      30.00|          f|\n|7174146d433b7726e...|          TX|             f|           Ms.|    high poverty| 2013-12-31|    suburban|             f|            f|                f|Grades PreK-2|                      30.00|          f|\n|207f67c9d30503593...|          NJ|             f|           Ms.|    high poverty| 2013-12-31|    suburban|             f|            f|                f|Grades PreK-2|                      30.00|          t|\n|d43b5e98aafd4bad8...|          CO|             f|           Mr.| highest poverty| 2013-12-31|       urban|             f|            t|                f|Grades PreK-2|                      30.00|          t|\n+--------------------+------------+--------------+--------------+----------------+-----------+------------+--------------+-------------+-----------------+-------------+---------------------------+-----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750627409,"submitTime":1524750621411,"finishTime":1524750632555,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"19947573-3735-4f9f-b584-f7ad0eaf46e3"},{"version":"CommandV1","origId":3413744942634580,"guid":"2b6922f4-4788-4e31-9f74-01c3379559d4","subtype":"command","commandType":"auto","position":13.0,"command":"val projects_1=sqlDF2.select(sqlDF2(\"date_posted\").cast(\"date\"),sqlDF2(\"is_exciting\"),sqlDF2(\"poverty_level\"), sqlDF2(\"school_state\"),sqlDF2(\"school_charter\"),sqlDF2(\"teacher_prefix\"),sqlDF2(\"school_magnet\"), sqlDF2(\"school_year_round\"), sqlDF2(\"grade_level\"),sqlDF2(\"fulfillment_labor_materials\").cast(\"double\"))\nprojects_1.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+\n|date_posted|is_exciting|   poverty_level|school_state|school_charter|teacher_prefix|school_magnet|school_year_round|  grade_level|fulfillment_labor_materials|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+\n| 2013-12-31|          f|moderate poverty|          IL|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|\n| 2013-12-31|          f|    high poverty|          ID|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|\n| 2013-12-31|          f|moderate poverty|          NH|             f|          Mrs.|            f|                f|   Grades 6-8|                       30.0|\n| 2013-12-31|          f| highest poverty|          VA|             f|           Ms.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          f| highest poverty|          IL|             f|           Mr.|            t|                f|   Grades 6-8|                       30.0|\n| 2013-12-31|          f|    high poverty|          SC|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          f| highest poverty|          KY|             f|          Mrs.|            t|                t|Grades PreK-2|                       30.0|\n| 2013-12-31|          f| highest poverty|          FL|             f|           Ms.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          f| highest poverty|          FL|             t|          Mrs.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          t|moderate poverty|          WY|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          f| highest poverty|          NY|             f|           Ms.|            f|                f|   Grades 3-5|                       30.0|\n| 2013-12-31|          f|    high poverty|          FL|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|\n| 2013-12-31|          f| highest poverty|          NM|             f|          Mrs.|            f|                f|  Grades 9-12|                       30.0|\n| 2013-12-31|          f| highest poverty|          NC|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          f|    high poverty|          AZ|             f|           Ms.|            f|                t|Grades PreK-2|                       30.0|\n| 2013-12-31|          f|    high poverty|          MI|             t|           Ms.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          f| highest poverty|          MO|             f|           Ms.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          f|    high poverty|          TX|             f|           Ms.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          t|    high poverty|          NJ|             f|           Ms.|            f|                f|Grades PreK-2|                       30.0|\n| 2013-12-31|          t| highest poverty|          CO|             f|           Mr.|            t|                f|Grades PreK-2|                       30.0|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+\nonly showing top 20 rows\n\nprojects_1: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 8 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"projects_1","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":"<div class=\"ansiout\">notebook:1: error: not found: value IntegerType\nval projects_1=sqlDF2.select(sqlDF2(&quot;date_posted&quot;).cast(&quot;date&quot;),sqlDF2(&quot;is_exciting&quot;),sqlDF2(&quot;poverty_level&quot;), sqlDF2(&quot;school_state&quot;),sqlDF2(&quot;school_charter&quot;),sqlDF2(&quot;teacher_prefix&quot;),sqlDF2(&quot;school_magnet&quot;), sqlDF2(&quot;school_year_round&quot;), sqlDF2(&quot;grade_level&quot;),sqlDF2(&quot;fulfillment_labor_materials&quot;).cast(IntegerType))\n                                                                                                                                                                                                                                                                                                               ^\n</div>","error":null,"workflows":[],"startTime":1524750632561,"submitTime":1524750624529,"finishTime":1524750638694,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f26c5c59-7106-43c0-9aa0-1614e652f963"},{"version":"CommandV1","origId":2330922003610796,"guid":"545fd6d6-d8c7-42c1-b1e8-79e5111f8e3a","subtype":"command","commandType":"auto","position":20.0,"command":"val indexer1 = new StringIndexer()\n                   .setInputCol(\"is_exciting\")\n                   .setOutputCol(\"label\")\n                   .fit(projects_1)\n\nval indexed1 = indexer1.transform(projects_1)\n                                \nval indexer2 = new StringIndexer()\n                   .setInputCol(\"poverty_level\")\n                   .setOutputCol(\"poverty\")\n                   .fit(indexed1)\n\nval indexed2 = indexer2.transform(indexed1)\n\nval indexer3 = new StringIndexer()\n                   .setInputCol(\"school_state\")\n                   .setOutputCol(\"state\")\n                   .fit(indexed2)\n\nval indexed3 = indexer3.transform(indexed2)\n\nval indexer4 = new StringIndexer()\n                   .setInputCol(\"school_charter\")\n                   .setOutputCol(\"charter\")\n                   .fit(indexed3)\n\nval indexed4 = indexer4.transform(indexed3)\n\nval indexer5 = new StringIndexer()\n                   .setInputCol(\"teacher_prefix\")\n                   .setOutputCol(\"gender\")\n                   .fit(indexed4)\n\nval indexed5 = indexer5.transform(indexed4)\n\n\n\nindexed5.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+\n|date_posted|is_exciting|   poverty_level|school_state|school_charter|teacher_prefix|school_magnet|school_year_round|  grade_level|fulfillment_labor_materials|label|poverty|state|charter|gender|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+\n| 2012-10-03|          f| highest poverty|          CA|             f|           Ms.|            f|                t|Grades PreK-2|                       30.0|  0.0|    0.0|  0.0|    0.0|   1.0|\n| 2013-04-28|          f|    high poverty|          MN|             f|           Mr.|            t|                f|   Grades 3-5|                       30.0|  0.0|    1.0| 31.0|    0.0|   2.0|\n| 2012-11-21|          f|moderate poverty|          GA|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|  0.0|    2.0|  7.0|    0.0|   0.0|\n| 2013-06-10|          f| highest poverty|          WA|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|  0.0|    0.0| 12.0|    0.0|   0.0|\n| 2013-03-08|          f|moderate poverty|          NC|             f|           Ms.|            f|                t|   Grades 3-5|                       30.0|  0.0|    2.0|  4.0|    0.0|   1.0|\n| 2012-10-27|          f|moderate poverty|          VA|             f|           Ms.|            f|                f|   Grades 3-5|                       30.0|  0.0|    2.0| 19.0|    0.0|   1.0|\n| 2012-07-28|          f|    high poverty|          FL|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|  0.0|    1.0|  3.0|    0.0|   0.0|\n| 2011-04-06|          f| highest poverty|          AR|             f|           Mr.|            f|                f|   Grades 6-8|                       35.0|  0.0|    0.0| 28.0|    0.0|   2.0|\n| 2012-11-01|          f|    high poverty|          KS|             f|           Mr.|            f|                f|Grades PreK-2|                       30.0|  0.0|    1.0| 38.0|    0.0|   2.0|\n| 2012-08-28|          f|    high poverty|          CA|             f|           Mr.|            f|                f|   Grades 6-8|                       30.0|  0.0|    1.0|  0.0|    0.0|   2.0|\n| 2013-12-16|          f|    high poverty|          CA|             f|           Mr.|            f|                f|   Grades 3-5|                       30.0|  0.0|    1.0|  0.0|    0.0|   2.0|\n| 2012-05-09|          f| highest poverty|          IN|             f|           Ms.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0| 10.0|    0.0|   1.0|\n| 2013-11-04|          f|    high poverty|          SC|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|  0.0|    1.0|  9.0|    0.0|   0.0|\n| 2012-09-10|          t| highest poverty|          CA|             t|           Ms.|            f|                f|  Grades 9-12|                       30.0|  1.0|    0.0|  0.0|    1.0|   1.0|\n| 2011-10-20|          f|moderate poverty|          IN|             f|           Mr.|            f|                f|   Grades 6-8|                       35.0|  0.0|    2.0| 10.0|    0.0|   2.0|\n| 2013-10-12|          f| highest poverty|          WA|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|  0.0|    0.0| 12.0|    0.0|   0.0|\n| 2012-09-04|          f|    high poverty|          IL|             f|          Mrs.|            f|                f|   Grades 6-8|                       30.0|  0.0|    1.0|  5.0|    0.0|   0.0|\n| 2013-08-21|          f| highest poverty|          FL|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|  0.0|    0.0|  3.0|    0.0|   0.0|\n| 2012-02-25|          f|    high poverty|          CA|             f|           Ms.|            f|                f|  Grades 9-12|                       35.0|  0.0|    1.0|  0.0|    0.0|   1.0|\n| 2013-11-05|          f|    high poverty|          TX|             f|           Ms.|            t|                f|   Grades 6-8|                       30.0|  0.0|    1.0|  2.0|    0.0|   1.0|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+\nonly showing top 20 rows\n\nindexer1: org.apache.spark.ml.feature.StringIndexerModel = strIdx_4982359d4972\nindexed1: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 9 more fields]\nindexer2: org.apache.spark.ml.feature.StringIndexerModel = strIdx_6738ef3acfee\nindexed2: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 10 more fields]\nindexer3: org.apache.spark.ml.feature.StringIndexerModel = strIdx_2ab20aeb1081\nindexed3: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 11 more fields]\nindexer4: org.apache.spark.ml.feature.StringIndexerModel = strIdx_1a54e92ec7dc\nindexed4: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 12 more fields]\nindexer5: org.apache.spark.ml.feature.StringIndexerModel = strIdx_945dded7b6f6\nindexed5: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 13 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"indexed1","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}}]},"tableIdentifier":null},{"name":"indexed2","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}}]},"tableIdentifier":null},{"name":"indexed3","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}}]},"tableIdentifier":null},{"name":"indexed4","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}}]},"tableIdentifier":null},{"name":"indexed5","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}}]},"tableIdentifier":null}]},"errorSummary":"<div class=\"ansiout\">notebook:2: error: too many arguments for method setInputCol: (value: String)org.apache.spark.ml.feature.StringIndexer\n                   .setInputCol(&quot;is_exciting&quot;,&quot;poverty_level&quot;)\n                               ^\n</div>","error":null,"workflows":[],"startTime":1524750638706,"submitTime":1524750625673,"finishTime":1524750687513,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f0e7c96e-cc50-45e7-aa4e-96a2e56bb889"},{"version":"CommandV1","origId":3059902435747513,"guid":"62752d70-4e7b-4828-8bc1-01b92cfdcbd1","subtype":"command","commandType":"auto","position":21.0,"command":"val encoder = new OneHotEncoderEstimator()\n  .setInputCols(Array(\"poverty\",\"state\",\"gender\"))\n  .setOutputCols(Array(\"cat_poverty\",\"cat_state\",\"cat_gender\"))\nval model = encoder.fit(indexed5)\n\nval encoded = model.transform(indexed5)\nencoded.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+\n|date_posted|is_exciting|   poverty_level|school_state|school_charter|teacher_prefix|school_magnet|school_year_round|  grade_level|fulfillment_labor_materials|label|poverty|state|charter|gender|  cat_poverty|      cat_state|   cat_gender|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+\n| 2012-10-03|          f| highest poverty|          CA|             f|           Ms.|            f|                t|Grades PreK-2|                       30.0|  0.0|    0.0|  0.0|    0.0|   1.0|(3,[0],[1.0])| (50,[0],[1.0])|(3,[1],[1.0])|\n| 2013-04-28|          f|    high poverty|          MN|             f|           Mr.|            t|                f|   Grades 3-5|                       30.0|  0.0|    1.0| 31.0|    0.0|   2.0|(3,[1],[1.0])|(50,[31],[1.0])|(3,[2],[1.0])|\n| 2012-11-21|          f|moderate poverty|          GA|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|  0.0|    2.0|  7.0|    0.0|   0.0|(3,[2],[1.0])| (50,[7],[1.0])|(3,[0],[1.0])|\n| 2013-06-10|          f| highest poverty|          WA|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|  0.0|    0.0| 12.0|    0.0|   0.0|(3,[0],[1.0])|(50,[12],[1.0])|(3,[0],[1.0])|\n| 2013-03-08|          f|moderate poverty|          NC|             f|           Ms.|            f|                t|   Grades 3-5|                       30.0|  0.0|    2.0|  4.0|    0.0|   1.0|(3,[2],[1.0])| (50,[4],[1.0])|(3,[1],[1.0])|\n| 2012-10-27|          f|moderate poverty|          VA|             f|           Ms.|            f|                f|   Grades 3-5|                       30.0|  0.0|    2.0| 19.0|    0.0|   1.0|(3,[2],[1.0])|(50,[19],[1.0])|(3,[1],[1.0])|\n| 2012-07-28|          f|    high poverty|          FL|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|  0.0|    1.0|  3.0|    0.0|   0.0|(3,[1],[1.0])| (50,[3],[1.0])|(3,[0],[1.0])|\n| 2011-04-06|          f| highest poverty|          AR|             f|           Mr.|            f|                f|   Grades 6-8|                       35.0|  0.0|    0.0| 28.0|    0.0|   2.0|(3,[0],[1.0])|(50,[28],[1.0])|(3,[2],[1.0])|\n| 2012-11-01|          f|    high poverty|          KS|             f|           Mr.|            f|                f|Grades PreK-2|                       30.0|  0.0|    1.0| 38.0|    0.0|   2.0|(3,[1],[1.0])|(50,[38],[1.0])|(3,[2],[1.0])|\n| 2012-08-28|          f|    high poverty|          CA|             f|           Mr.|            f|                f|   Grades 6-8|                       30.0|  0.0|    1.0|  0.0|    0.0|   2.0|(3,[1],[1.0])| (50,[0],[1.0])|(3,[2],[1.0])|\n| 2013-12-16|          f|    high poverty|          CA|             f|           Mr.|            f|                f|   Grades 3-5|                       30.0|  0.0|    1.0|  0.0|    0.0|   2.0|(3,[1],[1.0])| (50,[0],[1.0])|(3,[2],[1.0])|\n| 2012-05-09|          f| highest poverty|          IN|             f|           Ms.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0| 10.0|    0.0|   1.0|(3,[0],[1.0])|(50,[10],[1.0])|(3,[1],[1.0])|\n| 2013-11-04|          f|    high poverty|          SC|             f|          Mrs.|            f|                f|Grades PreK-2|                       30.0|  0.0|    1.0|  9.0|    0.0|   0.0|(3,[1],[1.0])| (50,[9],[1.0])|(3,[0],[1.0])|\n| 2012-09-10|          t| highest poverty|          CA|             t|           Ms.|            f|                f|  Grades 9-12|                       30.0|  1.0|    0.0|  0.0|    1.0|   1.0|(3,[0],[1.0])| (50,[0],[1.0])|(3,[1],[1.0])|\n| 2011-10-20|          f|moderate poverty|          IN|             f|           Mr.|            f|                f|   Grades 6-8|                       35.0|  0.0|    2.0| 10.0|    0.0|   2.0|(3,[2],[1.0])|(50,[10],[1.0])|(3,[2],[1.0])|\n| 2013-10-12|          f| highest poverty|          WA|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|  0.0|    0.0| 12.0|    0.0|   0.0|(3,[0],[1.0])|(50,[12],[1.0])|(3,[0],[1.0])|\n| 2012-09-04|          f|    high poverty|          IL|             f|          Mrs.|            f|                f|   Grades 6-8|                       30.0|  0.0|    1.0|  5.0|    0.0|   0.0|(3,[1],[1.0])| (50,[5],[1.0])|(3,[0],[1.0])|\n| 2013-08-21|          f| highest poverty|          FL|             f|          Mrs.|            f|                f|   Grades 3-5|                       30.0|  0.0|    0.0|  3.0|    0.0|   0.0|(3,[0],[1.0])| (50,[3],[1.0])|(3,[0],[1.0])|\n| 2012-02-25|          f|    high poverty|          CA|             f|           Ms.|            f|                f|  Grades 9-12|                       35.0|  0.0|    1.0|  0.0|    0.0|   1.0|(3,[1],[1.0])| (50,[0],[1.0])|(3,[1],[1.0])|\n| 2013-11-05|          f|    high poverty|          TX|             f|           Ms.|            t|                f|   Grades 6-8|                       30.0|  0.0|    1.0|  2.0|    0.0|   1.0|(3,[1],[1.0])| (50,[2],[1.0])|(3,[1],[1.0])|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+\nonly showing top 20 rows\n\nencoder: org.apache.spark.ml.feature.OneHotEncoderEstimator = oneHotEncoder_a95c1acb6104\nmodel: org.apache.spark.ml.feature.OneHotEncoderModel = oneHotEncoder_a95c1acb6104\nencoded: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 16 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"encoded","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}}]},"tableIdentifier":null}]},"errorSummary":"java.lang.IllegalArgumentException: requirement failed: Column poverty already exists.","error":"<div class=\"ansiout\">\tat scala.Predef$.require(Predef.scala:224)\n\tat org.apache.spark.ml.util.SchemaUtils$.appendColumn(SchemaUtils.scala:101)\n\tat org.apache.spark.ml.feature.OneHotEncoderBase$$anonfun$validateAndTransformSchema$3.apply(OneHotEncoderEstimator.scala:93)\n\tat org.apache.spark.ml.feature.OneHotEncoderBase$$anonfun$validateAndTransformSchema$3.apply(OneHotEncoderEstimator.scala:92)\n\tat scala.collection.IndexedSeqOptimized$class.foldl(IndexedSeqOptimized.scala:57)\n\tat scala.collection.IndexedSeqOptimized$class.foldLeft(IndexedSeqOptimized.scala:66)\n\tat scala.collection.mutable.ArrayOps$ofRef.foldLeft(ArrayOps.scala:186)\n\tat org.apache.spark.ml.feature.OneHotEncoderBase$class.validateAndTransformSchema(OneHotEncoderEstimator.scala:92)\n\tat org.apache.spark.ml.feature.OneHotEncoderEstimator.validateAndTransformSchema(OneHotEncoderEstimator.scala:120)\n\tat org.apache.spark.ml.feature.OneHotEncoderEstimator.transformSchema(OneHotEncoderEstimator.scala:145)\n\tat org.apache.spark.ml.feature.OneHotEncoderEstimator.fit(OneHotEncoderEstimator.scala:151)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3059902435747513:4)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3059902435747513:66)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3059902435747513:68)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$$iw$$iw$$iw.&lt;init&gt;(command-3059902435747513:70)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$$iw$$iw.&lt;init&gt;(command-3059902435747513:72)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$$iw.&lt;init&gt;(command-3059902435747513:74)\n\tat linea67f3864b5294f538719c89f8923161f76.$read.&lt;init&gt;(command-3059902435747513:76)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$.&lt;init&gt;(command-3059902435747513:80)\n\tat linea67f3864b5294f538719c89f8923161f76.$read$.&lt;clinit&gt;(command-3059902435747513)\n\tat linea67f3864b5294f538719c89f8923161f76.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linea67f3864b5294f538719c89f8923161f76.$eval$.$print(&lt;notebook&gt;:6)\n\tat linea67f3864b5294f538719c89f8923161f76.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:500)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:249)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:229)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:43)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:229)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1524750687539,"submitTime":1524750626615,"finishTime":1524750699165,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"91eb3095-a709-40d4-bae3-ef10c6cab469"},{"version":"CommandV1","origId":2575927416221267,"guid":"b1474e37-ffd5-48cd-af0b-cba41155ce77","subtype":"command","commandType":"auto","position":21.5,"command":"val assembler = new VectorAssembler()\n  .setInputCols(Array(\"cat_poverty\",\"cat_state\",\"cat_gender\",\"charter\",\"fulfillment_labor_materials\"))\n  .setOutputCol(\"features\")\n\nval output = assembler.transform(encoded)\noutput.select(\"features\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+\n|            features|\n+--------------------+\n|(58,[2,8,53,57],[...|\n|(58,[1,45,53,57],...|\n|(58,[2,48,53,57],...|\n|(58,[0,22,54,57],...|\n|(58,[0,8,55,57],[...|\n|(58,[1,12,53,57],...|\n|(58,[0,33,53,57],...|\n|(58,[0,6,54,57],[...|\n|(58,[0,6,53,56,57...|\n|(58,[2,53,57],[1....|\n|(58,[0,4,54,57],[...|\n|(58,[1,6,53,57],[...|\n|(58,[0,40,53,57],...|\n|(58,[0,7,53,57],[...|\n|(58,[1,18,54,57],...|\n|(58,[1,17,54,56,5...|\n|(58,[0,16,54,57],...|\n|(58,[1,5,54,57],[...|\n|(58,[1,23,54,57],...|\n|(58,[0,27,55,57],...|\n+--------------------+\nonly showing top 20 rows\n\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_e1d3d02ae97b\noutput: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 17 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"output","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null}]},"errorSummary":"<div class=\"ansiout\">notebook:2: error: type mismatch;\n found   : String(&quot;cat_poverty&quot;)\n required: Array[String]\n  .setInputCols(&quot;cat_poverty&quot;)\n                ^\n</div>","error":null,"workflows":[],"startTime":1524753451467,"submitTime":1524753451454,"finishTime":1524753455324,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a53fb138-1afc-45c3-9873-6891d8f48f0f"},{"version":"CommandV1","origId":2575927416221265,"guid":"38198884-7f21-48de-a8ed-b96ea61fd89d","subtype":"command","commandType":"auto","position":23.0,"command":"//logistic Regression model\nval Array(train, test) = output.randomSplit(Array(0.9, 0.1))\nimport org.apache.spark.ml.classification.LogisticRegression \nval lr = new LogisticRegression().setMaxIter(1000) .setRegParam(0.09) .setElasticNetParam(0.9)\nval lrModel = lr.fit(train)\nval result = lrModel.transform(test) \nresult.show()\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+--------------------+--------------------+--------------------+----------+\n|date_posted|is_exciting|   poverty_level|school_state|school_charter|teacher_prefix|school_magnet|school_year_round|  grade_level|fulfillment_labor_materials|label|poverty|state|charter|gender|  cat_poverty|      cat_state|   cat_gender|            features|       rawPrediction|         probability|prediction|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+--------------------+--------------------+--------------------+----------+\n| 2011-01-03|          f| highest poverty|          NJ|             f|          Mrs.|            f|                f|  Grades 9-12|                       35.0|  0.0|    0.0| 20.0|    0.0|   0.0|(3,[0],[1.0])|(50,[20],[1.0])|(3,[0],[1.0])|(58,[0,23,53,57],...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-01-09|          f| highest poverty|          IL|             f|           Ms.|            f|                f|   Grades 6-8|                       35.0|  0.0|    0.0|  5.0|    0.0|   1.0|(3,[0],[1.0])| (50,[5],[1.0])|(3,[1],[1.0])|(58,[0,8,54,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-01-15|          f|    high poverty|          FL|             f|           Mr.|            f|                f|  Grades 9-12|                       35.0|  0.0|    1.0|  3.0|    0.0|   2.0|(3,[1],[1.0])| (50,[3],[1.0])|(3,[2],[1.0])|(58,[1,6,55,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-01-16|          f| highest poverty|          MO|             t|          Mrs.|            f|                f|   Grades 6-8|                       35.0|  0.0|    0.0| 13.0|    1.0|   0.0|(3,[0],[1.0])|(50,[13],[1.0])|(3,[0],[1.0])|(58,[0,16,53,56,5...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-01-21|          f|    high poverty|          OH|             f|          Mrs.|            f|                f|   Grades 3-5|                       35.0|  0.0|    1.0| 23.0|    0.0|   0.0|(3,[1],[1.0])|(50,[23],[1.0])|(3,[0],[1.0])|(58,[1,26,53,57],...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-01-23|          f| highest poverty|          AZ|             f|           Ms.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0| 15.0|    0.0|   1.0|(3,[0],[1.0])|(50,[15],[1.0])|(3,[1],[1.0])|(58,[0,18,54,57],...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-01-26|          f| highest poverty|          WA|             f|           Ms.|            f|                f|   Grades 3-5|                       35.0|  0.0|    0.0| 12.0|    0.0|   1.0|(3,[0],[1.0])|(50,[12],[1.0])|(3,[1],[1.0])|(58,[0,15,54,57],...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-01-27|          t| highest poverty|          CA|             t|           Ms.|            f|                f|  Grades 9-12|                       35.0|  1.0|    0.0|  0.0|    1.0|   1.0|(3,[0],[1.0])| (50,[0],[1.0])|(3,[1],[1.0])|(58,[0,3,54,56,57...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-02-02|          f| highest poverty|          FL|             f|           Mr.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0|  3.0|    0.0|   2.0|(3,[0],[1.0])| (50,[3],[1.0])|(3,[2],[1.0])|(58,[0,6,55,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-02-13|          f|    high poverty|          IL|             f|          Mrs.|            f|                f|   Grades 3-5|                       35.0|  0.0|    1.0|  5.0|    0.0|   0.0|(3,[1],[1.0])| (50,[5],[1.0])|(3,[0],[1.0])|(58,[1,8,53,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-02-13|          f| highest poverty|          CA|             f|          Mrs.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0|  0.0|    0.0|   0.0|(3,[0],[1.0])| (50,[0],[1.0])|(3,[0],[1.0])|(58,[0,3,53,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-02-25|          f|moderate poverty|          OR|             f|           Ms.|            f|                f|   Grades 3-5|                       35.0|  0.0|    2.0| 27.0|    0.0|   1.0|(3,[2],[1.0])|(50,[27],[1.0])|(3,[1],[1.0])|(58,[2,30,54,57],...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-01|          f|    high poverty|          NY|             f|           Ms.|            f|                t|   Grades 6-8|                       35.0|  0.0|    1.0|  1.0|    0.0|   1.0|(3,[1],[1.0])| (50,[1],[1.0])|(3,[1],[1.0])|(58,[1,4,54,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-01|          f| highest poverty|          NC|             f|           Ms.|            t|                f|Grades PreK-2|                       35.0|  0.0|    0.0|  4.0|    0.0|   1.0|(3,[0],[1.0])| (50,[4],[1.0])|(3,[1],[1.0])|(58,[0,7,54,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-17|          f| highest poverty|          NC|             f|          Mrs.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0|  4.0|    0.0|   0.0|(3,[0],[1.0])| (50,[4],[1.0])|(3,[0],[1.0])|(58,[0,7,53,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-20|          f| highest poverty|          AL|             f|          Mrs.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0| 32.0|    0.0|   0.0|(3,[0],[1.0])|(50,[32],[1.0])|(3,[0],[1.0])|(58,[0,35,53,57],...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-21|          f| highest poverty|          CA|             t|           Ms.|            f|                f|   Grades 6-8|                       35.0|  0.0|    0.0|  0.0|    1.0|   1.0|(3,[0],[1.0])| (50,[0],[1.0])|(3,[1],[1.0])|(58,[0,3,54,56,57...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-23|          f| highest poverty|          IL|             f|           Ms.|            t|                f|Grades PreK-2|                       35.0|  0.0|    0.0|  5.0|    0.0|   1.0|(3,[0],[1.0])| (50,[5],[1.0])|(3,[1],[1.0])|(58,[0,8,54,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-25|          t|    high poverty|          FL|             f|           Mr.|            t|                f|  Grades 9-12|                       35.0|  1.0|    1.0|  3.0|    0.0|   2.0|(3,[1],[1.0])| (50,[3],[1.0])|(3,[2],[1.0])|(58,[1,6,55,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n| 2011-03-29|          f|moderate poverty|          NY|             f|          Mrs.|            f|                f|  Grades 9-12|                       35.0|  0.0|    2.0|  1.0|    0.0|   0.0|(3,[2],[1.0])| (50,[1],[1.0])|(3,[0],[1.0])|(58,[2,4,53,57],[...|[2.31972568843821...|[0.91049758905990...|       0.0|\n+-----------+-----------+----------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\ntrain: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\nimport org.apache.spark.ml.classification.LogisticRegression\nlr: org.apache.spark.ml.classification.LogisticRegression = logreg_e849ed6707bb\nlrModel: org.apache.spark.ml.classification.LogisticRegressionModel = logreg_e849ed6707bb\nresult: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 20 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"result","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}},{"name":"rawPrediction","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"probability","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":"java.lang.IllegalArgumentException: Field \"features\" does not exist.","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:267)\n\tat org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:267)\n\tat scala.collection.MapLike$class.getOrElse(MapLike.scala:128)\n\tat scala.collection.AbstractMap.getOrElse(Map.scala:59)\n\tat org.apache.spark.sql.types.StructType.apply(StructType.scala:266)\n\tat org.apache.spark.ml.util.SchemaUtils$.checkColumnType(SchemaUtils.scala:40)\n\tat org.apache.spark.ml.PredictorParams$class.validateAndTransformSchema(Predictor.scala:51)\n\tat org.apache.spark.ml.classification.Classifier.org$apache$spark$ml$classification$ClassifierParams$$super$validateAndTransformSchema(Classifier.scala:58)\n\tat org.apache.spark.ml.classification.ClassifierParams$class.validateAndTransformSchema(Classifier.scala:42)\n\tat org.apache.spark.ml.classification.ProbabilisticClassifier.org$apache$spark$ml$classification$ProbabilisticClassifierParams$$super$validateAndTransformSchema(ProbabilisticClassifier.scala:53)\n\tat org.apache.spark.ml.classification.ProbabilisticClassifierParams$class.validateAndTransformSchema(ProbabilisticClassifier.scala:37)\n\tat org.apache.spark.ml.classification.LogisticRegression.org$apache$spark$ml$classification$LogisticRegressionParams$$super$validateAndTransformSchema(LogisticRegression.scala:278)\n\tat org.apache.spark.ml.classification.LogisticRegressionParams$class.validateAndTransformSchema(LogisticRegression.scala:265)\n\tat org.apache.spark.ml.classification.LogisticRegression.validateAndTransformSchema(LogisticRegression.scala:278)\n\tat org.apache.spark.ml.Predictor.transformSchema(Predictor.scala:144)\n\tat org.apache.spark.ml.PipelineStage.transformSchema(Pipeline.scala:74)\n\tat org.apache.spark.ml.Predictor.fit(Predictor.scala:100)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221265:3)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221265:67)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221265:69)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$$iw$$iw$$iw.&lt;init&gt;(command-2575927416221265:71)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$$iw$$iw.&lt;init&gt;(command-2575927416221265:73)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$$iw.&lt;init&gt;(command-2575927416221265:75)\n\tat linea67f3864b5294f538719c89f8923161f86.$read.&lt;init&gt;(command-2575927416221265:77)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$.&lt;init&gt;(command-2575927416221265:81)\n\tat linea67f3864b5294f538719c89f8923161f86.$read$.&lt;clinit&gt;(command-2575927416221265)\n\tat linea67f3864b5294f538719c89f8923161f86.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linea67f3864b5294f538719c89f8923161f86.$eval$.$print(&lt;notebook&gt;:6)\n\tat linea67f3864b5294f538719c89f8923161f86.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:500)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:249)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:229)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:43)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:229)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1524753217478,"submitTime":1524753217449,"finishTime":1524753242955,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4587c364-f1f7-407f-a9cf-7757dab39cdc"},{"version":"CommandV1","origId":2575927416221266,"guid":"91923a47-6ec2-4a71-bd3f-8b5b5a42ddd8","subtype":"command","commandType":"auto","position":24.0,"command":"// logistic Regression Result\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nval evaluator = new MulticlassClassificationEvaluator()\nevaluator.setLabelCol(\"label\")\nevaluator.setMetricName(\"accuracy\")\nval accuracy = evaluator.evaluate(result)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_957d7959579b\naccuracy: Double = 0.9092978807128\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750764200,"submitTime":1524750764155,"finishTime":1524750794164,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"56e6e889-2e49-4fd6-a4dd-08bdefd875a0"},{"version":"CommandV1","origId":4186973666342066,"guid":"2b7a78b0-25a2-47e0-8ab9-691379b07101","subtype":"command","commandType":"auto","position":24.25,"command":"// logistic Regression hyperparameter tunning\nval Array(train, test) = output.randomSplit(Array(0.7, 0.3))\nval lr_new = new LogisticRegression()\n             .setMaxIter(10)\n\nval pipeline = new Pipeline().setStages(Array(lr_new)) \n\nval paramGrid = new ParamGridBuilder()\n  .addGrid(lr_new.regParam, Array(0.1, 0.01))\n  .build()\n\nval evaluator = new MulticlassClassificationEvaluator()\n  .setLabelCol(\"label\")\n  .setPredictionCol(\"prediction\")\n  // \"f1\" (default), \"weightedPrecision\", \"weightedRecall\", \"accuracy\"\n  .setMetricName(metric) \n\nval cv = new CrossValidator()\n  // ml.Pipeline with ml.classification.RandomForestClassifier\n  .setEstimator(pipeline)\n  // ml.evaluation.MulticlassClassificationEvaluator\n  .setEvaluator(evaluator) \n  .setEstimatorParamMaps(paramGrid)\n  .setNumFolds(nFolds)\n\nval model = cv.fit(train) // trainingData: DataFrame\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">train: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\nlr_new: org.apache.spark.ml.classification.LogisticRegression = logreg_d10f5c9feae6\npipeline: org.apache.spark.ml.Pipeline = pipeline_ea0e9fab5e79\nparamGrid: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\tlogreg_d10f5c9feae6-regParam: 0.1\n}, {\n\tlogreg_d10f5c9feae6-regParam: 0.01\n})\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_516f659f76b4\ncv: org.apache.spark.ml.tuning.CrossValidator = cv_ad3b4b59f781\nmodel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_ad3b4b59f781\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null}]},"errorSummary":"java.lang.NullPointerException","error":"<div class=\"ansiout\">\tat org.apache.spark.ml.tuning.ValidatorParams$class.logTuningParams(ValidatorParams.scala:85)\n\tat org.apache.spark.ml.tuning.CrossValidator.logTuningParams(CrossValidator.scala:68)\n\tat org.apache.spark.ml.tuning.CrossValidator.fit(CrossValidator.scala:134)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:20)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:135)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:137)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:139)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:141)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:143)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:145)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw$$iw.&lt;init&gt;(command-4186973666342066:147)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw$$iw.&lt;init&gt;(command-4186973666342066:149)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$$iw.&lt;init&gt;(command-4186973666342066:151)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read.&lt;init&gt;(command-4186973666342066:153)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$.&lt;init&gt;(command-4186973666342066:157)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$read$.&lt;clinit&gt;(command-4186973666342066)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$eval$.$print(&lt;notebook&gt;:6)\n\tat linea86bdf41a1fb477bbdfc6689fac2b053174.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:500)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:189)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:249)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:229)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:43)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:229)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1524754790459,"submitTime":1524754790433,"finishTime":1524755295148,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"42932a19-5c71-44ae-ae7b-4721c7d69a1c"},{"version":"CommandV1","origId":4186973666342067,"guid":"d073f2af-7570-45d8-8dc3-962f98c3b6b4","subtype":"command","commandType":"auto","position":24.375,"command":"// logstic regression best result\n\nval predictions = model.transform(test)\npredictions.select(\"label\", \"prediction\").show(5)\n\nval evaluator = new MulticlassClassificationEvaluator()\nevaluator.setLabelCol(\"label\")\nevaluator.setMetricName(\"accuracy\")\nval accuracy = evaluator.evaluate(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----------+\n|label|prediction|\n+-----+----------+\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n+-----+----------+\nonly showing top 5 rows\n\npredictions: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 20 more fields]\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_0782565b4e8a\naccuracy: Double = 0.9108423702189671\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}},{"name":"rawPrediction","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"probability","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524755306195,"submitTime":1524755306189,"finishTime":1524755336063,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b8b0953f-6c87-4a2b-bab9-ca5e7552fb88"},{"version":"CommandV1","origId":4186973666342068,"guid":"7d7cf8a1-f7e7-4966-959f-de2e0ba6de18","subtype":"command","commandType":"auto","position":24.4375,"command":"//support vector machine \nimport org.apache.spark.ml.classification.{LogisticRegression, OneVsRest, LinearSVC}\nval Array(train, test) = output.randomSplit(Array(0.7, 0.3))\nval svc = new LinearSVC()\n          .setMaxIter(10)\n\nval pipeline = new Pipeline().setStages(Array(svc)) \n\nval paramGrid = new ParamGridBuilder()\n  .addGrid(svc.regParam, Array(0.1, 0.01))\n  .build()\n\nval evaluator = new MulticlassClassificationEvaluator()\n  .setLabelCol(\"label\")\n  .setPredictionCol(\"prediction\")\n  // \"f1\" (default), \"weightedPrecision\", \"weightedRecall\", \"accuracy\"\n  .setMetricName(metric) \n\nval cv = new CrossValidator()\n  // ml.Pipeline with ml.classification.RandomForestClassifier\n  .setEstimator(pipeline)\n  // ml.evaluation.MulticlassClassificationEvaluator\n  .setEvaluator(evaluator) \n  .setEstimatorParamMaps(paramGrid)\n  .setNumFolds(nFolds)\n\nval model = cv.fit(train) // trainingData: DataFrame","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.classification.{LogisticRegression, OneVsRest, LinearSVC}\ntrain: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\nsvc: org.apache.spark.ml.classification.LinearSVC = linearsvc_04c82cc15540\npipeline: org.apache.spark.ml.Pipeline = pipeline_50aedc1dcae7\nparamGrid: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\tlinearsvc_04c82cc15540-regParam: 0.1\n}, {\n\tlinearsvc_04c82cc15540-regParam: 0.01\n})\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_f1185567bad1\ncv: org.apache.spark.ml.tuning.CrossValidator = cv_e3bfda553af7\nmodel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_e3bfda553af7\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null}]},"errorSummary":"<div class=\"ansiout\">notebook:3: error: not found: type LinearSVC\nval svc = new LinearSVC()\n              ^\n</div>","error":null,"workflows":[],"startTime":1524755883398,"submitTime":1524755883381,"finishTime":1524757486742,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"74ffd0a9-ffcc-4618-b20e-a3609447d4de"},{"version":"CommandV1","origId":4186973666342069,"guid":"60a512d8-8463-4291-bf16-c1f2acce6a56","subtype":"command","commandType":"auto","position":24.46875,"command":"// SVM best result\n\nval predictions = model.transform(test)\npredictions.select(\"label\", \"prediction\").show(5)\n\nval evaluator = new MulticlassClassificationEvaluator()\nevaluator.setLabelCol(\"label\")\nevaluator.setMetricName(\"accuracy\")\nval accuracy = evaluator.evaluate(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----------+\n|label|prediction|\n+-----+----------+\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n+-----+----------+\nonly showing top 5 rows\n\npredictions: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 19 more fields]\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_da9671649e75\naccuracy: Double = 0.9106829790661751\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}},{"name":"rawPrediction","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524757529183,"submitTime":1524757529152,"finishTime":1524757558241,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"055a8d80-7978-4271-a9b1-1c38291172d8"},{"version":"CommandV1","origId":272706934037289,"guid":"f3e07775-c450-4e0d-a7d0-8cd3a2ad1e45","subtype":"command","commandType":"auto","position":24.5,"command":"//Random forest model\nval Array(train, test) = output.randomSplit(Array(0.75, 0.25))\n\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.classification.{RandomForestClassificationModel, RandomForestClassifier}\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.feature.{IndexToString, StringIndexer, VectorIndexer}\n\nval classifier = new RandomForestClassifier()\n  .setImpurity(\"gini\")\n  .setMaxDepth(3)\n  .setNumTrees(20)\n  .setFeatureSubsetStrategy(\"auto\")\n  .setSeed(5043)\nval model = classifier.fit(train)\n\nval predictions = model.transform(test)\npredictions.select(\"label\", \"prediction\").show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----------+\n|label|prediction|\n+-----+----------+\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  1.0|       0.0|\n+-----+----------+\nonly showing top 5 rows\n\ntrain: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.classification.{RandomForestClassificationModel, RandomForestClassifier}\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.feature.{IndexToString, StringIndexer, VectorIndexer}\nclassifier: org.apache.spark.ml.classification.RandomForestClassifier = rfc_a676dd76ab77\nmodel: org.apache.spark.ml.classification.RandomForestClassificationModel = RandomForestClassificationModel (uid=rfc_a676dd76ab77) with 20 trees\npredictions: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 20 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}},{"name":"rawPrediction","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"probability","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524750799330,"submitTime":1524750799294,"finishTime":1524750868211,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"801d55e4-8932-45a2-a1db-f383f795ce59"},{"version":"CommandV1","origId":272706934037290,"guid":"fabb4429-7a4b-4cc3-a043-b7309b8d44c6","subtype":"command","commandType":"auto","position":24.75,"command":"//Random forest result\n\nval evaluator = new MulticlassClassificationEvaluator()\nevaluator.setLabelCol(\"label\")\nevaluator.setMetricName(\"accuracy\")\nval accuracy = evaluator.evaluate(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">evaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_58e314908c7d\naccuracy: Double = 0.9118934305419606\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">notebook:4: error: type mismatch;\n found   : org.apache.spark.ml.classification.RandomForestClassificationModel\n required: org.apache.spark.sql.Dataset[_]\nval accuracy = evaluator.evaluate(model)\n                                  ^\n</div>","error":null,"workflows":[],"startTime":1524750876851,"submitTime":1524750876825,"finishTime":1524750901239,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fbf6f133-0ce8-48c6-a98b-a34a6fe6684e"},{"version":"CommandV1","origId":272706934037291,"guid":"850decb5-e61b-4fb5-9e96-8ba2e141e621","subtype":"command","commandType":"auto","position":24.875,"command":"//Random forest hyperparameter tuning\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\n\n// [label: double, features: vector] \nval nFolds: Int = 5\nval NumTrees: Int = 20\nval metric: String = \"accuracy\"\n\nval rf = new RandomForestClassifier()\n  .setLabelCol(\"label\")\n  .setFeaturesCol(\"features\")\n  .setNumTrees(NumTrees)\n\nval pipeline = new Pipeline().setStages(Array(rf)) \n\nval paramGrid = new ParamGridBuilder().build() // No parameter search\n\nval evaluator = new MulticlassClassificationEvaluator()\n  .setLabelCol(\"label\")\n  .setPredictionCol(\"prediction\")\n  // \"f1\" (default), \"weightedPrecision\", \"weightedRecall\", \"accuracy\"\n  .setMetricName(metric) \n\nval cv = new CrossValidator()\n  // ml.Pipeline with ml.classification.RandomForestClassifier\n  .setEstimator(pipeline)\n  // ml.evaluation.MulticlassClassificationEvaluator\n  .setEvaluator(evaluator) \n  .setEstimatorParamMaps(paramGrid)\n  .setNumFolds(nFolds)\n\nval model = cv.fit(train) // trainingData: DataFrame","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nnFolds: Int = 5\nNumTrees: Int = 20\nmetric: String = accuracy\nrf: org.apache.spark.ml.classification.RandomForestClassifier = rfc_0912c7fe149a\npipeline: org.apache.spark.ml.Pipeline = pipeline_ed03567a41a6\nparamGrid: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\n})\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_2d8208f61323\ncv: org.apache.spark.ml.tuning.CrossValidator = cv_fb0ed060251a\nmodel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_fb0ed060251a\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">notebook:15: error: value setNumtrees is not a member of org.apache.spark.ml.classification.RandomForestClassifier\npossible cause: maybe a semicolon is missing before `value setNumtrees'?\n  .setNumtrees(NumTrees)\n   ^\n</div>","error":null,"workflows":[],"startTime":1524752360990,"submitTime":1524752360974,"finishTime":1524752897985,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"510b43c2-4bc5-40ff-a813-4bf5aa9358da"},{"version":"CommandV1","origId":4186973666342065,"guid":"93230fcb-072e-46c6-8e4a-1dd2266ff391","subtype":"command","commandType":"auto","position":24.9375,"command":"val predictions = model.transform(test)\npredictions.select(\"label\", \"prediction\").show(5)\n\nval evaluator = new MulticlassClassificationEvaluator()\nevaluator.setLabelCol(\"label\")\nevaluator.setMetricName(\"accuracy\")\nval accuracy = evaluator.evaluate(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----------+\n|label|prediction|\n+-----+----------+\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  1.0|       0.0|\n+-----+----------+\nonly showing top 5 rows\n\npredictions: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 20 more fields]\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_d99a73d4fc2d\naccuracy: Double = 0.9118934305419606\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}},{"name":"rawPrediction","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"probability","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524751550644,"submitTime":1524751550636,"finishTime":1524751595228,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d0da4af9-ab26-4a3a-b85a-00e65ee385b7"},{"version":"CommandV1","origId":4186973666342070,"guid":"14376584-6122-4359-8480-68f2d40d2296","subtype":"command","commandType":"auto","position":24.96875,"command":"//decision Tree\nval Array(train, test) = output.randomSplit(Array(0.75, 0.25))\nval algTree = new DecisionTreeClassifier()\nalgTree.setLabelCol(\"label\")\nalgTree.setImpurity(\"gini\") // could be \"entropy\"\nalgTree.setMaxBins(32)\nalgTree.setMaxDepth(5)\n\nval mdlTree = algTree.fit(train)\n\nval predictions = mdlTree.transform(test)\npredictions.show(5)\n\nval evaluator = new MulticlassClassificationEvaluator()\nevaluator.setLabelCol(\"label\")\nevaluator.setMetricName(\"accuracy\")\nval accuracy = evaluator.evaluate(result)\n\nprintln(\"The tree has %d nodes.\".format(mdlTree.numNodes))\nprintln(mdlTree.toDebugString)\nprintln(mdlTree.toString)\nprintln(mdlTree.featureImportances)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+-----------+---------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+--------------------+-----------------+--------------------+----------+\n|date_posted|is_exciting|  poverty_level|school_state|school_charter|teacher_prefix|school_magnet|school_year_round|  grade_level|fulfillment_labor_materials|label|poverty|state|charter|gender|  cat_poverty|      cat_state|   cat_gender|            features|    rawPrediction|         probability|prediction|\n+-----------+-----------+---------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+--------------------+-----------------+--------------------+----------+\n| 2011-01-12|          f|highest poverty|          NM|             f|           Ms.|            f|                f|   Grades 6-8|                       35.0|  0.0|    0.0| 37.0|    0.0|   1.0|(3,[0],[1.0])|(50,[37],[1.0])|(3,[1],[1.0])|(58,[0,40,54,57],...| [58280.0,6615.0]|[0.89806610678788...|       0.0|\n| 2011-01-12|          f|    low poverty|          CA|             f|          Mrs.|            f|                f|Grades PreK-2|                       35.0|  0.0|    3.0|  0.0|    0.0|   0.0|    (3,[],[])| (50,[0],[1.0])|(3,[0],[1.0])|(58,[3,53,57],[1....|  [14553.0,870.0]|[0.94359074110095...|       0.0|\n| 2011-01-15|          f|   high poverty|          FL|             f|           Mr.|            f|                f|  Grades 9-12|                       35.0|  0.0|    1.0|  3.0|    0.0|   2.0|(3,[1],[1.0])| (50,[3],[1.0])|(3,[2],[1.0])|(58,[1,6,55,57],[...|[100561.0,8621.0]|[0.92104009818468...|       0.0|\n| 2011-01-15|          f|highest poverty|          FL|             f|           Ms.|            f|                f|Grades PreK-2|                       35.0|  0.0|    0.0|  3.0|    0.0|   1.0|(3,[0],[1.0])| (50,[3],[1.0])|(3,[1],[1.0])|(58,[0,6,54,57],[...| [58280.0,6615.0]|[0.89806610678788...|       0.0|\n| 2011-01-17|          f|   high poverty|          FL|             f|           Mr.|            f|                f|  Grades 9-12|                       35.0|  0.0|    1.0|  3.0|    0.0|   2.0|(3,[1],[1.0])| (50,[3],[1.0])|(3,[2],[1.0])|(58,[1,6,55,57],[...|[100561.0,8621.0]|[0.92104009818468...|       0.0|\n+-----------+-----------+---------------+------------+--------------+--------------+-------------+-----------------+-------------+---------------------------+-----+-------+-----+-------+------+-------------+---------------+-------------+--------------------+-----------------+--------------------+----------+\nonly showing top 5 rows\n\nThe tree has 61 nodes.\nDecisionTreeClassificationModel (uid=dtc_5708a0d11080) of depth 5 with 61 nodes\n  If (feature 54 in {1.0})\n   If (feature 56 in {1.0})\n    If (feature 20 in {1.0})\n     If (feature 57 &lt;= 32.5)\n      If (feature 2 in {1.0})\n       Predict: 0.0\n      Else (feature 2 not in {1.0})\n       Predict: 0.0\n     Else (feature 57 &gt; 32.5)\n      If (feature 1 in {1.0})\n       Predict: 0.0\n      Else (feature 1 not in {1.0})\n       Predict: 0.0\n    Else (feature 20 not in {1.0})\n     If (feature 36 in {1.0})\n      If (feature 2 in {1.0})\n       Predict: 0.0\n      Else (feature 2 not in {1.0})\n       Predict: 0.0\n     Else (feature 36 not in {1.0})\n      If (feature 4 in {1.0})\n       Predict: 0.0\n      Else (feature 4 not in {1.0})\n       Predict: 0.0\n   Else (feature 56 not in {1.0})\n    If (feature 36 in {1.0})\n     If (feature 2 in {1.0})\n      Predict: 0.0\n     Else (feature 2 not in {1.0})\n      If (feature 1 in {1.0})\n       Predict: 0.0\n      Else (feature 1 not in {1.0})\n       Predict: 0.0\n    Else (feature 36 not in {1.0})\n     If (feature 3 in {1.0})\n      If (feature 57 &lt;= 32.5)\n       Predict: 0.0\n      Else (feature 57 &gt; 32.5)\n       Predict: 0.0\n     Else (feature 3 not in {1.0})\n      If (feature 8 in {1.0})\n       Predict: 0.0\n      Else (feature 8 not in {1.0})\n       Predict: 0.0\n  Else (feature 54 not in {1.0})\n   If (feature 56 in {1.0})\n    If (feature 19 in {1.0})\n     If (feature 2 in {0.0})\n      If (feature 53 in {0.0})\n       Predict: 0.0\n      Else (feature 53 not in {0.0})\n       Predict: 0.0\n     Else (feature 2 not in {0.0})\n      If (feature 57 &lt;= 32.5)\n       Predict: 0.0\n      Else (feature 57 &gt; 32.5)\n       Predict: 0.0\n    Else (feature 19 not in {1.0})\n     If (feature 6 in {1.0})\n      If (feature 57 &lt;= 32.5)\n       Predict: 0.0\n      Else (feature 57 &gt; 32.5)\n       Predict: 0.0\n     Else (feature 6 not in {1.0})\n      If (feature 7 in {1.0})\n       Predict: 0.0\n      Else (feature 7 not in {1.0})\n       Predict: 0.0\n   Else (feature 56 not in {1.0})\n    If (feature 8 in {1.0})\n     If (feature 53 in {0.0})\n      If (feature 57 &lt;= 32.5)\n       Predict: 0.0\n      Else (feature 57 &gt; 32.5)\n       Predict: 0.0\n     Else (feature 53 not in {0.0})\n      If (feature 0 in {0.0})\n       Predict: 0.0\n      Else (feature 0 not in {0.0})\n       Predict: 0.0\n    Else (feature 8 not in {1.0})\n     If (feature 3 in {1.0})\n      If (feature 57 &lt;= 32.5)\n       Predict: 0.0\n      Else (feature 57 &gt; 32.5)\n       Predict: 0.0\n     Else (feature 3 not in {1.0})\n      If (feature 19 in {1.0})\n       Predict: 0.0\n      Else (feature 19 not in {1.0})\n       Predict: 0.0\n\nDecisionTreeClassificationModel (uid=dtc_5708a0d11080) of depth 5 with 61 nodes\n(58,[0,1,2,3,4,6,7,8,19,20,36,53,54,56,57],[0.001249200699975297,0.003936788385601206,0.013739601319106272,0.08291231351575537,0.01700363980278993,0.010281278774409049,0.00893451649108646,0.08445967646752829,0.051593163873226155,0.027372219713185975,0.07716594080688419,0.009814714120958672,0.3298217042122468,0.24447262052112173,0.03724262129612483])\ntrain: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date_posted: date, is_exciting: string ... 17 more fields]\nalgTree: org.apache.spark.ml.classification.DecisionTreeClassifier = dtc_5708a0d11080\nmdlTree: org.apache.spark.ml.classification.DecisionTreeClassificationModel = DecisionTreeClassificationModel (uid=dtc_5708a0d11080) of depth 5 with 61 nodes\npredictions: org.apache.spark.sql.DataFrame = [date_posted: date, is_exciting: string ... 20 more fields]\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_906ac594d5fc\naccuracy: Double = 0.9106267184444004\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}}]},"tableIdentifier":null},{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"date_posted","type":"date","nullable":true,"metadata":{}},{"name":"is_exciting","type":"string","nullable":false,"metadata":{}},{"name":"poverty_level","type":"string","nullable":true,"metadata":{}},{"name":"school_state","type":"string","nullable":true,"metadata":{}},{"name":"school_charter","type":"string","nullable":true,"metadata":{}},{"name":"teacher_prefix","type":"string","nullable":true,"metadata":{}},{"name":"school_magnet","type":"string","nullable":true,"metadata":{}},{"name":"school_year_round","type":"string","nullable":true,"metadata":{}},{"name":"grade_level","type":"string","nullable":true,"metadata":{}},{"name":"fulfillment_labor_materials","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"label"}}},{"name":"poverty","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["highest poverty","high poverty","moderate poverty","low poverty"],"type":"nominal","name":"poverty"}}},{"name":"state","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["CA","NY","TX","FL","NC","IL","TN","GA","PA","SC","IN","OK","WA","MO","MI","AZ","UT","LA","MA","VA","NJ","MD","NV","OH","CO","CT","WI","OR","AR","MS","KY","MN","AL","DC","ME","HI","IA","NM","KS","WV","DE","RI","ID","AK","NE","NH","SD","MT","VT","ND","WY"],"type":"nominal","name":"state"}}},{"name":"charter","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["f","t"],"type":"nominal","name":"charter"}}},{"name":"gender","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["Mrs.","Ms.","Mr.","Dr."],"type":"nominal","name":"gender"}}},{"name":"cat_poverty","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"highest poverty"},{"idx":1,"name":"high poverty"},{"idx":2,"name":"moderate poverty"}]},"num_attrs":3}}},{"name":"cat_state","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"CA"},{"idx":1,"name":"NY"},{"idx":2,"name":"TX"},{"idx":3,"name":"FL"},{"idx":4,"name":"NC"},{"idx":5,"name":"IL"},{"idx":6,"name":"TN"},{"idx":7,"name":"GA"},{"idx":8,"name":"PA"},{"idx":9,"name":"SC"},{"idx":10,"name":"IN"},{"idx":11,"name":"OK"},{"idx":12,"name":"WA"},{"idx":13,"name":"MO"},{"idx":14,"name":"MI"},{"idx":15,"name":"AZ"},{"idx":16,"name":"UT"},{"idx":17,"name":"LA"},{"idx":18,"name":"MA"},{"idx":19,"name":"VA"},{"idx":20,"name":"NJ"},{"idx":21,"name":"MD"},{"idx":22,"name":"NV"},{"idx":23,"name":"OH"},{"idx":24,"name":"CO"},{"idx":25,"name":"CT"},{"idx":26,"name":"WI"},{"idx":27,"name":"OR"},{"idx":28,"name":"AR"},{"idx":29,"name":"MS"},{"idx":30,"name":"KY"},{"idx":31,"name":"MN"},{"idx":32,"name":"AL"},{"idx":33,"name":"DC"},{"idx":34,"name":"ME"},{"idx":35,"name":"HI"},{"idx":36,"name":"IA"},{"idx":37,"name":"NM"},{"idx":38,"name":"KS"},{"idx":39,"name":"WV"},{"idx":40,"name":"DE"},{"idx":41,"name":"RI"},{"idx":42,"name":"ID"},{"idx":43,"name":"AK"},{"idx":44,"name":"NE"},{"idx":45,"name":"NH"},{"idx":46,"name":"SD"},{"idx":47,"name":"MT"},{"idx":48,"name":"VT"},{"idx":49,"name":"ND"}]},"num_attrs":50}}},{"name":"cat_gender","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":0,"name":"Mrs."},{"idx":1,"name":"Ms."},{"idx":2,"name":"Mr."}]},"num_attrs":3}}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":57,"name":"fulfillment_labor_materials"}],"nominal":[{"vals":["f","t"],"idx":56,"name":"charter"}],"binary":[{"idx":0,"name":"cat_poverty_highest poverty"},{"idx":1,"name":"cat_poverty_high poverty"},{"idx":2,"name":"cat_poverty_moderate poverty"},{"idx":3,"name":"cat_state_CA"},{"idx":4,"name":"cat_state_NY"},{"idx":5,"name":"cat_state_TX"},{"idx":6,"name":"cat_state_FL"},{"idx":7,"name":"cat_state_NC"},{"idx":8,"name":"cat_state_IL"},{"idx":9,"name":"cat_state_TN"},{"idx":10,"name":"cat_state_GA"},{"idx":11,"name":"cat_state_PA"},{"idx":12,"name":"cat_state_SC"},{"idx":13,"name":"cat_state_IN"},{"idx":14,"name":"cat_state_OK"},{"idx":15,"name":"cat_state_WA"},{"idx":16,"name":"cat_state_MO"},{"idx":17,"name":"cat_state_MI"},{"idx":18,"name":"cat_state_AZ"},{"idx":19,"name":"cat_state_UT"},{"idx":20,"name":"cat_state_LA"},{"idx":21,"name":"cat_state_MA"},{"idx":22,"name":"cat_state_VA"},{"idx":23,"name":"cat_state_NJ"},{"idx":24,"name":"cat_state_MD"},{"idx":25,"name":"cat_state_NV"},{"idx":26,"name":"cat_state_OH"},{"idx":27,"name":"cat_state_CO"},{"idx":28,"name":"cat_state_CT"},{"idx":29,"name":"cat_state_WI"},{"idx":30,"name":"cat_state_OR"},{"idx":31,"name":"cat_state_AR"},{"idx":32,"name":"cat_state_MS"},{"idx":33,"name":"cat_state_KY"},{"idx":34,"name":"cat_state_MN"},{"idx":35,"name":"cat_state_AL"},{"idx":36,"name":"cat_state_DC"},{"idx":37,"name":"cat_state_ME"},{"idx":38,"name":"cat_state_HI"},{"idx":39,"name":"cat_state_IA"},{"idx":40,"name":"cat_state_NM"},{"idx":41,"name":"cat_state_KS"},{"idx":42,"name":"cat_state_WV"},{"idx":43,"name":"cat_state_DE"},{"idx":44,"name":"cat_state_RI"},{"idx":45,"name":"cat_state_ID"},{"idx":46,"name":"cat_state_AK"},{"idx":47,"name":"cat_state_NE"},{"idx":48,"name":"cat_state_NH"},{"idx":49,"name":"cat_state_SD"},{"idx":50,"name":"cat_state_MT"},{"idx":51,"name":"cat_state_VT"},{"idx":52,"name":"cat_state_ND"},{"idx":53,"name":"cat_gender_Mrs."},{"idx":54,"name":"cat_gender_Ms."},{"idx":55,"name":"cat_gender_Mr."}]},"num_attrs":58}}},{"name":"rawPrediction","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"probability","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524757729651,"submitTime":1524757729621,"finishTime":1524757793434,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7da635e8-f75f-4756-a2e0-77f08e2f2505"}],"dashboards":[],"guid":"2f0c3824-86ca-4be3-a2eb-a9758aec4db8","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
